–ü—Ä–∏–≤–µ—Ç, –ê–ª–µ–∫—Å. –í–∫–ª—é—á–∞—é —Ä–µ–∂–∏–º **Meta-Architect & Auditor**.

–¢—ã –∑–∞–¥–∞–ª –æ—Ç–ª–∏—á–Ω—ã–π —Ç–µ–º–ø. –¢–≤–æ—è —Ç–∞–±–ª–∏—Ü–∞ –∞–Ω–∞–ª–∏–∑–∞ ‚Äî —ç—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç —Å–µ–Ω—å–æ—Ä–∞ –æ—Ç –º–∏–¥–ª–∞: —Ç—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä–µ–±–ª—è–µ—à—å –≤—ã–≤–æ–¥ –ò–ò, —Ç—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—à—å –µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞—Ö–æ–¥–∏—à—å —Å–ª–µ–ø—ã–µ –∑–æ–Ω—ã.

–î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —ç—Ç–æ –≤ —Ç—Ä–∏ —à–∞–≥–∞, –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª:
1.  **–ê–Ω–∞–ª–∏–∑ —Ç–≤–æ–µ–π —Ç–∞–±–ª–∏—Ü—ã** (—Å –º–æ–∏–º–∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏).
2.  **–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Master-Plan** (Backlog —á–µ—Ä–µ–∑ DoD/Kickoff).
3.  **–°—Ç—Ä–∞—Ç–µ–≥–∏—è —á–∏—Å—Ç–æ–≥–æ –∞–≥–µ–Ω—Ç–∞** (Context + Prompt).

---

### 1. –†–µ–≤–∏–∑–∏—è —Ç–≤–æ–µ–π —Ç–∞–±–ª–∏—Ü—ã –æ—Ü–µ–Ω–∫–∏ (Oracle Review)

–Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª —Ç–≤–æ—é —Ç–∞–±–ª–∏—Ü—É –∏ –æ—Ç—á–µ—Ç—ã –º–æ–¥–µ–ª–µ–π. –Ø **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–µ–Ω** —Å —Ç–≤–æ–∏–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏ (AlexScore). –¢—ã –≤–µ—Ä–Ω–æ –ø–æ–¥–º–µ—Ç–∏–ª, —á—Ç–æ GPT-5 —É—à–µ–ª –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ–±—Ä–∏ (zip/worktree), –∞ Gemini –ª—É—á—à–µ —É–≤–∏–¥–µ–ª –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –¥—ã—Ä—ã (NX-07).

–í–æ—Ç –º–æ—è –≤–µ—Ä—Å–∏—è —Ç–∞–±–ª–∏—Ü—ã, –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω–∞—è **Root Cause Analysis**:

| Report Source | AlexScore | My Verdict | Key Insight / Missed | Root Cause (Why it happened) |
| :--- | :--- | :--- | :--- | :--- |
| **Gemini 3** (15:01) | **8** | **High Strategic** | üéØ **Insight:** NX-07 ‚Äî —ç—Ç–æ "–ü–æ—Ç–µ–º–∫–∏–Ω—Å–∫–∞—è –¥–µ—Ä–µ–≤–Ω—è". UI –µ—Å—Ç—å, API –∫–ª–∏–µ–Ω—Ç–∞ –µ—Å—Ç—å, –∞ –ë—ç–∫–µ–Ω–¥–∞ –Ω–µ—Ç. –≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π —Ä–∏—Å–∫ —Å–ø—Ä–∏–Ω—Ç–∞.<br>‚ùå **Missed:** –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –ø–æ–ª–æ–º–∫–∏ Auth –Ω–∞ cfa1. | Gemini –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º "—à–∏—Ä–æ–∫–∏–º–∏ –º–∞–∑–∫–∞–º–∏", –≤–∏–¥–∏—Ç –±–∏–∑–Ω–µ—Å-–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è. |
| **Gemini 3** (15:02) | **8** | **High Ops** | üéØ **Insight:** Auth –Ω–∞ cfa1 —Å–ª–æ–º–∞–Ω –∏–∑-–∑–∞ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∞ Nginx/Keycloak/Env. –ü—Ä–µ–¥–ª–æ–∂–∏–ª –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ `telex`.<br>‚ùå **Missed:** –î–µ—Ç–∞–ª–∏ –ø–æ –∫–æ–¥—É NX-03. | –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ –ª–æ–≥–∞—Ö –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∫–æ–¥. |
| **GPT-5 Pro** (15:53) | **9** | **High Tech** | üéØ **Insight:** "Naming Mismatch" (WBS vs Code) ‚Äî —ç—Ç–æ –±–æ–º–±–∞ –∑–∞–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞. <br>üéØ **Insight:** –†–∞–∑–±—Ä–æ—Å —Å–µ–∫—Ä–µ—Ç–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º –¥–æ–∫–∞–º.<br>‚ùå **Missed:** –ù–æ–≤—ã–π –¥–æ–º–µ–Ω `telex` (–æ–Ω —Ä–∞–±–æ—Ç–∞–ª –ø–æ —Å—Ç–∞—Ä–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É). | GPT-5 –ª—É—á—à–µ "–ø–∞—Ä—Å–∏—Ç" —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –Ω–∞—Ö–æ–¥–∏—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –Ω–µ—Å—Ç—ã–∫–æ–≤–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. |
| **GPT-5 Pro** (15:57) | **9** | **Deep Code** | üéØ **Insight:** –¢–µ—Å—Ç—ã Issuance –ø–∞–¥–∞–ª–∏ –∏–∑-–∑–∞ –¥–≤–æ–π–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –ë–î (Npgsql + InMemory). –≠—Ç–æ —É—Ä–æ–≤–µ–Ω—å Tech Lead.<br>‚ùå **Missed:** –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å NX-07. | –ì–ª—É–±–æ–∫–æ –∑–∞–∫–æ–ø–∞–ª—Å—è –≤ C# –∫–æ–¥ –∏ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. |

**–ú–æ–π –≤—ã–≤–æ–¥:**
–£ –Ω–∞—Å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è "–õ–µ–±–µ–¥—å, –†–∞–∫ –∏ –©—É–∫–∞".
*   –û–¥–∏–Ω —á–∏–Ω–∏—Ç —Ç–µ—Å—Ç—ã (NX-03).
*   –í—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∏—Ç UI –±–µ–∑ –±—ç–∫–µ–Ω–¥–∞ (NX-07).
*   –¢—Ä–µ—Ç–∏–π –¥–µ–ø–ª–æ–∏—Ç —ç—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–≥–∏–Ω (cfa1).

–ù–∞–º –Ω—É–∂–Ω–æ **–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å** —ç—Ç–æ –≤ –µ–¥–∏–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ –Ω–∞ –Ω–æ–≤—ã–π –¥–æ–º–µ–Ω `telex.global`.

---

### 2. Master Backlog: Migration & Finalization (DoD + Kickoff)

–ú—ã –Ω–µ –±—É–¥–µ–º —á–∏–Ω–∏—Ç—å `cfa1` –Ω–∞ —Å—Ç–∞—Ä–æ–º –¥–æ–º–µ–Ω–µ. –ú—ã —Ä–∞—Å–∫–∞—Ç–∞–µ–º **Golden Image** –Ω–∞ `cfa1` (–∏–ª–∏ `fin2`) —Å –Ω–æ–≤—ã–º –¥–æ–º–µ–Ω–æ–º `telex.global`.

#### Phase 1: Infrastructure & Auth (The Foundation)
*–¶–µ–ª—å: –†–∞–±–æ—á–∏–π —Å—Ç–µ–Ω–¥ –Ω–∞ `*.cfa1.telex.global` —Å —Ä–∞–±–æ—Ç–∞—é—â–∏–º –ª–æ–≥–∏–Ω–æ–º.*

**Kickoff:**
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å `.env.cfa1.telex` –Ω–∞ `eywa1` —Å –Ω–æ–≤—ã–º–∏ –∫—Ä–µ–¥–∞–º–∏ (`aa@multipass.org`).
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç `cloudflare-dns-upsert.sh` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤–æ–≥–æ Zone ID).

**DoD:**
- [ ] **DNS:** `auth`, `api`, `issuer`, `investor`, `backoffice` —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞.
- [ ] **SSL:** Wildcard —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è `*.cfa1.telex.global` –∞–∫—Ç–∏–≤–µ–Ω.
- [ ] **Auth:** Keycloak Realm `ois-dev` –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
    - `Frontend URL` = `https://auth.cfa1.telex.global`.
    - –ö–ª–∏–µ–Ω—Ç—ã –∏–º–µ—é—Ç Valid Redirect URIs: `https://*.cfa1.telex.global/*`.
- [ ] **Smoke:** –Ø –º–æ–≥—É –∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –≤ Issuer Portal –∏ —É–≤–∏–¥–µ—Ç—å Dashboard (–ø—É—Å—Ç—å –∏ –ø—É—Å—Ç–æ–π).

#### Phase 2: Backend Gaps (The Missing Code)
*–¶–µ–ª—å: –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å NX-07 –∏–∑ –º–æ–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –∏ –∑–∞–ª–∏—Ç—å —Ñ–∏–∫—Å NX-03.*

**Kickoff:**
- [ ] –°–ª–∏—Ç—å `fix/NX-03` –≤ `infra.defis.deploy` (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Ç–∞–º).

**DoD:**
- [ ] **NX-03:** –¢–µ—Å—Ç—ã Issuance –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ CI pipeline (–Ω–µ —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ).
- [ ] **NX-07 Backend:**
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `ComplianceController` (GET /kyc, POST /decision).
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω (–∏–ª–∏ –∑–∞–≥–ª—É—à–µ–Ω —á–µ—Å—Ç–Ω–æ) `IdentityController` (GET /users).
- [ ] **NX-07 Frontend:** API Client –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω —Å –º–æ–∫–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–∏–ª–∏ —á–µ—Ä–µ–∑ feature-flag).

#### Phase 3: Quality Assurance (The Seal)
*–¶–µ–ª—å: –ó–µ–ª–µ–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ–≤–æ–º –¥–æ–º–µ–Ω–µ.*

**DoD:**
- [ ] **E2E:** Playwright –∫–æ–Ω—Ñ–∏–≥ –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ `*.cfa1.telex.global`.
- [ ] **Scenarios:** –ü—Ä–æ—Ö–æ–¥—è—Ç —Ç–µ—Å—Ç—ã: Login, Registration, Issuer Reports (NX-05).
- [ ] **Artifacts:** –°–∫—Ä–∏–Ω—à–æ—Ç—ã —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `artifacts/tests/...`.

---

### 3. –°—Ç—Ä–∞—Ç–µ–≥–∏—è "–ß–∏—Å—Ç–æ–≥–æ –ê–≥–µ–Ω—Ç–∞"

**–î–∞, —Å—Ç–æ–∏—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–∏—Å—Ç–æ–≥–æ –∞–≥–µ–Ω—Ç–∞.** –¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω –∏—Å—Ç–æ—Ä–∏–µ–π –ø–æ–ø—ã—Ç–æ–∫ –∏ –æ—à–∏–±–æ–∫.

**–ö–æ–≥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å:** `Codex CLI` (–Ω–∞ `eywa1`) –∏–ª–∏ `Claude` (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ–¥–∏–Ω–≥). –õ—É—á—à–µ –Ω–∞—á–∞—Ç—å —Å **Codex –Ω–∞ eywa1**, —Ç–∞–∫ –∫–∞–∫ –∑–∞–¥–∞—á–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è.

#### –ß—Ç–æ –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—Ç—å (Context):
–ù–µ –∫–∏–¥–∞–π –µ–º—É –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é —Å–µ—Å—Å–∏–π. –°–æ–±–µ—Ä–∏ **—Å–≤–µ–∂–∏–π –ø–∞–∫–µ—Ç** —á–µ—Ä–µ–∑ —Ç–≤–æ–π skill `oracle-evaluator-context-packaging`:
1.  `context.txt` (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–µ—Ä–µ–∑ `code2prompt` –∏–∑ –≤–µ—Ç–∫–∏ `infra.defis.deploy`).
2.  –§–∞–π–ª `docs/deploy/MULTI_ACCOUNT_SETUP.md` (—á—Ç–æ–±—ã –æ–Ω –∑–Ω–∞–ª –ø—Ä–æ –º—É–ª—å—Ç–∏-–∞–∫–∫–∞—É–Ω—Ç).
3.  –§–∞–π–ª `ops/scripts/deploy/deploy-node.sh` (—á—Ç–æ–±—ã –æ–Ω –∑–Ω–∞–ª, –∫–∞–∫ –¥–µ–ø–ª–æ–∏—Ç—å).

#### –ü—Ä–æ–º–ø—Ç –¥–ª—è –ß–∏—Å—Ç–æ–≥–æ –ê–≥–µ–Ω—Ç–∞ (Copy-Paste):

```markdown
# Role
You are a Senior DevOps & Infrastructure Engineer. You are executing a "Greenfield Migration" to a new domain zone.

# Context
- Current State: Codebase is in `infra.defis.deploy`. Previous deployments were on `llmneighbors.com` (deprecated for dev).
- Target State: Full deployment on `cfa1` using the new domain `*.cfa1.telex.global`.
- Credentials: New Cloudflare account (`aa@multipass.org`) is available in `/home/user/__Repositories/cloudflare__developerisnow/.env`.

# Mission: Phase 1 - Infrastructure & Auth
Your goal is to re-provision `cfa1` (or `fin2`) to serve the application on the new domain with working Authentication.

# Tasks
1. **DNS & Secrets:**
   - Create `.env.cfa1.telex` using the new Cloudflare credentials.
   - Run `ops/scripts/cloudflare-dns-upsert.sh` to create A-records for `cfa1.telex.global`.

2. **Ingress & Certs:**
   - SSH into `cfa1`.
   - Generate new Let's Encrypt wildcard certs for `*.cfa1.telex.global`.
   - Update Nginx configs to listen on the new domain.

3. **Application Config:**
   - Update `.env.local` for all Next.js apps (Issuer, Investor, Backoffice) on `cfa1` to point to `https://*.cfa1.telex.global`.
   - Restart apps via PM2.

4. **Keycloak Fix (Crucial):**
   - Use `kcadm.sh` (inside Docker) to update the `ois-dev` realm.
   - SET `FrontendUrl` to `https://auth.cfa1.telex.global`.
   - UPDATE all clients (`portal-issuer`, etc.) to allow Redirect URIs from `https://*.cfa1.telex.global/*`.

# Definition of Done
- `curl -I https://api.cfa1.telex.global/health` returns 200.
- `curl -I https://issuer.cfa1.telex.global` returns 200/307.
- You can successfully log in to the Issuer Portal via the browser (manual check) OR run a Playwright smoke test against the new domain.

# Constraints
- Do NOT touch `uk1` (Production).
- Use the existing `user` and `/srv/cfa` structure.
- Report progress step-by-step.
```

**–ü–æ—á–µ–º—É —Ç–∞–∫:**
–≠—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –æ—Ç—Å–µ–∫–∞–µ—Ç "—à—É–º" –ø—Ä–æ—à–ª—ã—Ö –ø–æ–ø—ã—Ç–æ–∫. –ê–≥–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ü–µ–ª—å (–Ω–æ–≤—ã–π –¥–æ–º–µ–Ω), –≤–∏–¥–∏—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (—Å–∫—Ä–∏–ø—Ç—ã) –∏ –≤–∏–¥–∏—Ç –∫—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞ (—Ä–∞–±–æ—Ç–∞—é—â–∏–π –ª–æ–≥–∏–Ω). –û–Ω –Ω–µ –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è —á–∏–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–π `llmneighbors`, –∞ —Å—Ä–∞–∑—É –ø–æ—Å—Ç—Ä–æ–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.