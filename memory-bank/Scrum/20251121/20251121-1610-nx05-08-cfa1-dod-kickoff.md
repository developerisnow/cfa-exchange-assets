---
created: 2025-11-21 16:10
updated: 2025-11-21 16:10
type: checklist
sphere: [exchange]
topic: [nx05, nx06, nx07, nx08, dod, kickoff]
author: alex-a
agentID: co-c02b-eywa1
partAgentID: [co-c02b]
version: 0.1.0
tags: [cfa1, deploy, dod, kickoff, verification]
---

# CFA1 — NX05/06/07/08: DoD + Kickoff (Проверить и дожать)

> Статус деплоя на CFA1 не подтверждён. Ниже чеклисты, что нужно верифицировать и доделать. UK1 не трогаем.

## DoD (что считать готовым)
- [ ] Код на CFA1 соответствует `infra.defis.deploy` (git rev-parse == origin/infra.defis.deploy).
- [ ] API Gateway: маршруты `/v1/reports/issuances` → issuance, `/v1/reports/payouts` → settlement, `/v1/identity/**` → identity, KYC routes → compliance.
- [ ] Issuer Dashboard/Reports (NX05): страницы отдают данные без моков; API `/v1/reports/issuances` и `/v1/reports/payouts` работают.
- [ ] Payout Schedule UI (NX06): секция отображает scheduleJson; нет падений.
- [ ] Backoffice KYC/Users/Audit (NX07/08): моки выключены (`NEXT_PUBLIC_*_MOCK_MODE=false`), API ответы 200, таблицы показывают реальные данные.
- [ ] Auth: Keycloak `ois-dev` роли issuer/investor/backoffice; логин проходит без verify-email блокера; redirect URIs под `*.cfa1.llmneighbors.com`.
- [ ] E2E/Smoke: базовые сценарии issuer/backoffice проходят на домене CFA1.

## Kickoff (с чего начать прямо на CFA1)
1) **Проверить ветку/коммит**  
   ```bash
   cd /srv/cfa/ois-cfa  # если другой путь — зафиксировать
   git rev-parse --abbrev-ref HEAD
   git rev-parse HEAD
   ```
2) **Запись конфигов**  
   - Сохранить копии `.env`, `.env.apps`, `.env.local*` (порталы), nginx site конфигов, ssl-путей.
3) **Запуск/рестарт**  
   - `docker compose` (используемые файлы) up/restart; убедиться, что api-gateway/issuance/settlement/compliance/identity running.
4) **Smoke для NX05/06**  
   - `curl https://api.cfa1.llmneighbors.com/health`  
   - `curl -I https://api.cfa1.llmneighbors.com/v1/reports/issuances` (ожидаем 401, не 404/5xx)  
   - Открыть issuer портал, проверить dashboard/reports табы.
5) **Backoffice (NX07/08)**  
   - Логин под `backoffice` ролью.  
   - `/kyc`: должен отображать список без моков.  
   - `/users`: отдаёт реальные записи из Identity (не заглушки).  
   - `/audit`: данные доступны без mock fallback.
6) **Auth sanity**  
   - Убедиться, что emailVerified выставлен для тест-аккаунтов, и Browser flow не требует Verify Email.  
   - Если SMTP не в строю — временно вручную проставлять emailVerified.

## Если найдены проблемы
- Зафиксировать в этом файле: дата, какой шаг упал, лог/ответ, текущий коммит.  
- Ссылки на фиксы/PR в `infra.defis.deploy`.  
- Для auth: экспорт realm (или kcadm скрипт) после исправления, чтобы не править руками повторно.
