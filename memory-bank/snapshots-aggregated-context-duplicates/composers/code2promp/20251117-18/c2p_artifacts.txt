Project Path: artifacts

Source Tree:

```txt
artifacts
‚îú‚îÄ‚îÄ AlexA
‚îÇ   ‚îú‚îÄ‚îÄ ois-cfa.reposcan.json
‚îÇ   ‚îú‚îÄ‚îÄ project-C4.diagram.md
‚îÇ   ‚îî‚îÄ‚îÄ project-reposcan.md
‚îú‚îÄ‚îÄ FRONTEND-FUNCTIONALITY-ANALYSIS.md
‚îú‚îÄ‚îÄ FRONTEND-STARTUP.md
‚îú‚îÄ‚îÄ KEYCLOAK-SETUP-GUIDE.md
‚îú‚îÄ‚îÄ KEYCLOAK-SETUP.md
‚îú‚îÄ‚îÄ OBSERVABILITY-SECURITY-ACCESS.md
‚îú‚îÄ‚îÄ gateway-routing-report.md
‚îú‚îÄ‚îÄ issuance-endpoints-coverage-report.md
‚îú‚îÄ‚îÄ issuance-test-report.txt
‚îú‚îÄ‚îÄ spec-lint-openapi.txt
‚îú‚îÄ‚îÄ spec-validate-asyncapi.txt
‚îî‚îÄ‚îÄ spec-validate-jsonschema.txt

```

`artifacts/AlexA/ois-cfa.reposcan.json`:

```json
{
    "meta": {
      "repo": "repositories/customer-gitlab/ois-cfa",
      "branch": "infra.defis.deploy",
      "generated_at": "2025-11-18T09:05:00Z",
      "summary": {
        "domains": ["issuance", "registry", "settlement", "compliance", "identity"],
        "tracks": ["spec-contracts", "backend-services", "api-gateway-frontends", "observability-security", "ci-infra"],
        "trunk_branch_leaf_rules": {
          "trunk": ["docs/context/**", "docs/deploy/**", "packages/contracts/**", "packages/domain/**"],
          "branch": ["services/**", "apps/**", "ops/**", "ops/gitops/**"],
          "leaf": ["tests/**", "ops/scripts/**", "tasks/NX-*.md", "memory-bank/**"]
        },
        "git_branches": {
          "trunk": ["main", "develop (planned from infra.defis.deploy)"],
          "branch": ["infra", "deploy", "infra.defis.deploy", "release/*"],
          "leaf": ["feature/NX-*"]
        }
      }
    },
    "tree": {
      "path": ".",
      "type": "dir",
      "children": [
        {
          "path": "apps",
          "type": "dir",
          "level": "branch",
          "size_class": "L",
          "tags": ["frontends", "edge"],
          "children": [
            {
              "path": "apps/api-gateway",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["gateway", "dotnet", "yarp"]
            },
            {
              "path": "apps/portal-issuer",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["frontend", "issuer", "nextjs"]
            },
            {
              "path": "apps/portal-investor",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["frontend", "investor", "nextjs"]
            },
            {
              "path": "apps/backoffice",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["frontend", "backoffice", "nextjs"]
            },
            {
              "path": "apps/broker-portal",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["frontend", "broker"]
            },
            {
              "path": "apps/shared-ui",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["frontend", "shared-ui", "design-system"]
            }
          ]
        },
        {
          "path": "services",
          "type": "dir",
          "level": "branch",
          "size_class": "L",
          "tags": ["backend", "services"],
          "children": [
            {
              "path": "services/issuance",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["service", "issuance", "events-outbox"]
            },
            {
              "path": "services/registry",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["service", "registry", "orders", "wallets"]
            },
            {
              "path": "services/settlement",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["service", "settlement", "payouts"]
            },
            {
              "path": "services/compliance",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["service", "compliance", "kyc", "audit"]
            },
            {
              "path": "services/identity",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["service", "identity", "oidc"]
            },
            {
              "path": "services/fabric-gateway",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["service", "fabric", "dlt-adapter"]
            },
            {
              "path": "services/integrations",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["integrations"],
              "children": [
                {
                  "path": "services/integrations/bank-nominal",
                  "type": "dir",
                  "level": "branch",
                  "size_class": "S",
                  "tags": ["integration", "bank"]
                },
                {
                  "path": "services/integrations/esia-adapter",
                  "type": "dir",
                  "level": "branch",
                  "size_class": "S",
                  "tags": ["integration", "esia"]
                },
                {
                  "path": "services/integrations/edo-connector",
                  "type": "dir",
                  "level": "branch",
                  "size_class": "S",
                  "tags": ["integration", "edo"]
                }
              ]
            }
          ]
        },
        {
          "path": "packages",
          "type": "dir",
          "level": "trunk",
          "size_class": "L",
          "tags": ["packages"],
          "children": [
            {
              "path": "packages/contracts",
              "type": "dir",
              "level": "trunk",
              "size_class": "M",
              "tags": ["contracts", "openapi", "asyncapi", "schemas"]
            },
            {
              "path": "packages/domain",
              "type": "dir",
              "level": "trunk",
              "size_class": "M",
              "tags": ["domain", "value-objects"]
            },
            {
              "path": "packages/sdks/typescript-gateway",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["sdk", "typescript", "gateway-client"]
            },
            {
              "path": "packages/sdks/ts",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["sdk", "typescript", "api-client"]
            },
            {
              "path": "packages/types/ts",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["types", "json-schema-generated"]
            },
            {
              "path": "packages/dotnet-clients/gateway",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["sdk", "dotnet", "gateway-client"]
            }
          ]
        },
        {
          "path": "docs",
          "type": "dir",
          "level": "trunk",
          "size_class": "L",
          "tags": ["docs"],
          "children": [
            {
              "path": "docs/context",
              "type": "dir",
              "level": "trunk",
              "size_class": "M",
              "tags": ["context", "wbs", "rules"]
            },
            {
              "path": "docs/architecture",
              "type": "dir",
              "level": "trunk",
              "size_class": "M",
              "tags": ["architecture", "c4", "api-specs"]
            },
            {
              "path": "docs/frontend",
              "type": "dir",
              "level": "branch",
              "size_class": "S",
              "tags": ["frontend-context"]
            },
            {
              "path": "docs/deploy",
              "type": "dir",
              "level": "trunk",
              "size_class": "M",
              "tags": ["deploy", "uk1", "runbooks"]
            },
            {
              "path": "docs/dlt",
              "type": "dir",
              "level": "trunk",
              "size_class": "S",
              "tags": ["fabric", "k8s"]
            }
          ]
        },
        {
          "path": "ops",
          "type": "dir",
          "level": "branch",
          "size_class": "L",
          "tags": ["ops", "infra", "gitops"],
          "children": [
            {
              "path": "ops/infra",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["k8s", "helm", "timeweb", "otel", "prometheus"]
            },
            {
              "path": "ops/gitops",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["gitops", "argocd", "uk1"]
            },
            {
              "path": "ops/scripts",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["scripts", "healthchecks", "restore", "validate-specs"]
            },
            {
              "path": "ops/fabric",
              "type": "dir",
              "level": "branch",
              "size_class": "M",
              "tags": ["fabric", "chaincode", "helm"]
            }
          ]
        },
        {
          "path": "tests",
          "type": "dir",
          "level": "leaf",
          "size_class": "L",
          "tags": ["tests"],
          "children": [
            {
              "path": "tests/issuance.Tests",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["backend-tests", "issuance"]
            },
            {
              "path": "tests/registry.Tests",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["backend-tests", "registry"]
            },
            {
              "path": "tests/settlement.Tests",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["backend-tests", "settlement"]
            },
            {
              "path": "tests/compliance.Tests",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["backend-tests", "compliance"]
            },
            {
              "path": "tests/contracts",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["pact", "contracts"]
            },
            {
              "path": "tests/e2e",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["e2e", "smoke"]
            },
            {
              "path": "tests/e2e-playwright",
              "type": "dir",
              "level": "leaf",
              "size_class": "S",
              "tags": ["playwright", "portals-journeys"]
            }
          ]
        },
        {
          "path": "tasks",
          "type": "dir",
          "level": "leaf",
          "size_class": "S",
          "tags": ["nx-tasks", "agents"]
        },
        {
          "path": "memory-bank",
          "type": "dir",
          "level": "leaf",
          "size_class": "S",
          "tags": ["decision-log", "reports"]
        },
        {
          "path": "AGENTS.md",
          "type": "file",
          "level": "trunk",
          "size_class": "S",
          "tags": ["agents-rules"]
        },
        {
          "path": "project.manifest.json",
          "type": "file",
          "level": "trunk",
          "size_class": "S",
          "tags": ["manifest", "monorepo-index"]
        }
      ]
    },
    "logical": {
      "domains": {
        "issuance": {
          "services": ["services/issuance"],
          "apps": ["apps/portal-issuer"],
          "contracts": ["packages/contracts/openapi-issuance.yaml", "packages/contracts/schemas/Issuance.json"],
          "tests": ["tests/issuance.Tests", "tests/e2e-playwright/issuer-journey.spec.ts"]
        },
        "registry": {
          "services": ["services/registry"],
          "apps": ["apps/portal-investor"],
          "contracts": ["packages/contracts/openapi-registry.yaml", "packages/contracts/schemas/Order.json"],
          "tests": ["tests/registry.Tests", "tests/contracts/pact-consumer", "tests/e2e-playwright/investor-journey.spec.ts"]
        },
        "settlement": {
          "services": ["services/settlement"],
          "apps": ["apps/backoffice"],
          "contracts": ["packages/contracts/openapi-settlement.yaml", "packages/contracts/schemas/Payout.json"],
          "tests": ["tests/settlement.Tests"]
        },
        "compliance": {
          "services": ["services/compliance"],
          "apps": ["apps/backoffice"],
          "contracts": ["packages/contracts/openapi-compliance.yaml", "packages/contracts/schemas/AuditEvent.json"],
          "tests": ["tests/compliance.Tests", "tests/e2e-playwright/backoffice-journey.spec.ts"]
        },
        "identity": {
          "services": ["services/identity"],
          "apps": ["apps/portal-issuer", "apps/portal-investor", "apps/backoffice"],
          "contracts": ["packages/contracts/openapi-identity.yaml"],
          "tests": []
        }
      },
      "frontends": [
        {
          "name": "portal-issuer",
          "root": "apps/portal-issuer",
          "guards": ["role:issuer"],
          "uses_sdk": "@ois/api-client"
        },
        {
          "name": "portal-investor",
          "root": "apps/portal-investor",
          "guards": ["role:investor"],
          "uses_sdk": "@ois/api-client"
        },
        {
          "name": "backoffice",
          "root": "apps/backoffice",
          "guards": ["role:backoffice", "role:admin"],
          "uses_sdk": "@ois/api-client"
        }
      ],
      "ops": [
        {
          "name": "uk1",
          "root": "docs/deploy/20251113-cloudflare-ingress.md",
          "level": "trunk"
        },
        {
          "name": "timeweb-k8s",
          "root": "ops/infra/timeweb",
          "level": "branch"
        },
        {
          "name": "fabric-network",
          "root": "ops/fabric",
          "level": "branch"
        }
      ],
      "tests": [
        {
          "name": "backend-unit",
          "roots": [
            "tests/issuance.Tests",
            "tests/registry.Tests",
            "tests/settlement.Tests",
            "tests/compliance.Tests"
          ]
        },
        {
          "name": "e2e-portals",
          "roots": [
            "tests/e2e-playwright"
          ]
        }
      ],
      "nx_index": {
        "NX-01": {
          "title": "Spec validation + API/Event Matrix",
          "task_doc": "tasks/NX-01-spec-validate-and-matrix.md",
          "level": "branch",
          "domains": ["cross-cutting"],
          "nodes": [
            "packages/contracts",
            "docs/context/WBS-OIS.md",
            "docs/architecture/api-event-matrix.md"
          ]
        },
        "NX-02": {
          "title": "API Gateway routing + health/metrics",
          "task_doc": "tasks/NX-02-gateway-routing-and-health.md",
          "level": "branch",
          "domains": ["cross-cutting"],
          "nodes": [
            "apps/api-gateway",
            "services/*",
            "docs/ops/gateway-routing.md"
          ]
        },
        "NX-03": {
          "title": "Issuance endpoints alignment + tests",
          "task_doc": "tasks/NX-03-issuance-endpoints-coverage.md",
          "level": "branch",
          "domains": ["issuance"],
          "nodes": [
            "services/issuance",
            "tests/issuance.Tests",
            "packages/contracts/openapi-issuance.yaml"
          ]
        },
        "NX-04": {
          "title": "Registry order flow (create‚Üíreserve‚Üípaid) + events",
          "task_doc": "tasks/NX-04-registry-orders-flow.md",
          "level": "branch",
          "domains": ["registry"],
          "nodes": [
            "services/registry",
            "tests/registry.Tests",
            "packages/contracts/openapi-registry.yaml",
            "packages/contracts/asyncapi.yaml"
          ]
        }
      }
    },
    "anchors": [
      {
        "path": "docs/context/PROJECT-CONTEXT.md",
        "role": "project-context",
        "level": "trunk",
        "tags": ["anchor", "context"]
      },
      {
        "path": "docs/context/WBS-OIS.md",
        "role": "wbs",
        "level": "trunk",
        "tags": ["anchor", "wbs", "nx"]
      },
      {
        "path": "docs/frontend/context-map.md",
        "role": "frontend-context",
        "level": "branch",
        "tags": ["anchor", "frontend", "contracts"]
      },
      {
        "path": "AGENTS.md",
        "role": "agents-rules",
        "level": "trunk",
        "tags": ["anchor", "agents", "rules"]
      },
      {
        "path": "docs/deploy/20251113-cloudflare-ingress.md",
        "role": "runbook:uk1",
        "level": "trunk",
        "tags": ["anchor", "ops", "uk1"]
      },
      {
        "path": "docs/dlt/k8s-deploy.md",
        "role": "runbook:fabric",
        "level": "trunk",
        "tags": ["anchor", "dlt", "k8s"]
      },
      {
        "path": "tasks/NX-03-issuance-endpoints-coverage.md",
        "role": "nx-task",
        "level": "branch",
        "tags": ["nx", "issuance"]
      },
      {
        "path": "tasks/NX-04-registry-orders-flow.md",
        "role": "nx-task",
        "level": "branch",
        "tags": ["nx", "registry"]
      }
    ]
  }
```

`artifacts/AlexA/project-C4.diagram.md`:

```md
---
created: 2025-11-11
updated: 2025-11-18-1619
author: AlexA
co-authrors: gpt5
type: diagram
tags: c4
previous:
next:  [reposcan]
related: []
---

# Project map

## 1. C1‚ÄìC4 –¥–∏–∞–≥—Ä–∞–º–º—ã Mermaid

### 1.1 C1 ‚Äî System Context OIS‚ÄëCFA –∏ –≤–Ω–µ—à–Ω–∏–µ –∞–∫—Ç–æ—Ä—ã

–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ PROJECT-CONTEXT, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö openapi‚Äë/asyncapi‚Äë–¥–æ–∫–∞—Ö –∏ –æ–ø–∏—Å–∞–Ω–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π —Å ESIA, –±–∞–Ω–∫–æ–º, EDO –∏ Fabric.

```mermaid
graph LR
  %% People
  subgraph Users
    issuer[Person: Issuer]
    investor[Person: Investor]
    broker[Person: Broker]
    backoffice[Person: Backoffice / Compliance]
  end

  %% Core system
  ois[System: OIS-CFA Platform]

  %% External systems
  subgraph External_Systems
    esia[[System: ESIA OIDC]]
    bank[[System: Bank Nominal Core]]
    edo[[System: EDO Provider]]
    fabric[[System: Fabric DLT Network]]
    regulator[[System: Regulator / CBR]]
  end

  %% People ‚Üí System
  issuer -->|–°–æ–∑–¥–∞–Ω–∏–µ/—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø—É—Å–∫–∞–º–∏, –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å| ois
  investor -->|–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, –ø–æ—Ä—Ç—Ñ–µ–ª—å, –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π| ois
  broker -->|–ë—Ä–æ–∫–µ—Ä—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å| ois
  backoffice -->|KYC/AML, –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞—É–¥–∏—Ç| ois

  %% System ‚Üí External systems
  ois -->|OIDC login, –ø—Ä–æ—Ñ–∏–ª—å| esia
  ois -->|–ü–ª–∞—Ç–µ–∂–∏, —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–ø–∏—Å–∞–Ω–∏—è| bank
  ois -->|–Æ—Ä. –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ| edo
  ois -->|–†–µ–µ—Å—Ç—Ä –∞–∫—Ç–∏–≤–æ–≤, —Å–¥–µ–ª–∫–∏ –Ω–∞ DLT| fabric
  ois -->|–†–µ–≥—É–ª—è—Ç–æ—Ä–Ω–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å, –≤—ã–≥—Ä—É–∑–∫–∏| regulator
```

---

### 1.2 C2 ‚Äî Containers —Ñ—Ä–æ–Ω—Ç—ã, gateway, —Å–µ—Ä–≤–∏—Å—ã, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∑—è—Ç—ã –∏–∑ –¥–µ—Ä–µ–≤–∞ `apps/*`, `services/*`, `ops/infra/*`, `packages/contracts/*` –∏ API/Event‚Äë–º–∞—Ç—Ä–∏—Ü—ã –≤ PROJECT-CONTEXT.

```mermaid
graph TB
  %% Frontend portals
  subgraph Frontends
    fe_issuer[Container: Portal Issuer Next.js\napps/portal-issuer]
    fe_investor[Container: Portal Investor Next.js\napps/portal-investor]
    fe_backoffice[Container: Backoffice Next.js\napps/backoffice]
    fe_broker[Container: Broker Portal Next.js\napps/broker-portal]
  end

  %% Edge layer
  subgraph Edge
    api_gw[Container: API Gateway .NET + YARP\napps/api-gateway]
    keycloak[Container: Keycloak IdP]
  end

  %% Domain services
  subgraph Domain_Services
    svc_issuance[Container: Issuance Service .NET\nservices/issuance]
    svc_registry[Container: Registry Service .NET\nservices/registry]
    svc_settlement[Container: Settlement Service .NET\nservices/settlement]
    svc_compliance[Container: Compliance Service .NET\nservices/compliance]
    svc_identity[Container: Identity Service .NET\nservices/identity]
    svc_fabric_gw[Container: Fabric Gateway .NET\nservices/fabric-gateway]
  end

  %% Integrations
  subgraph Integrations
    svc_bank[Container: Bank Nominal Adapter\nservices/integrations/bank-nominal]
    svc_esia[Container: ESIA Adapter\nservices/integrations/esia-adapter]
    svc_edo[Container: EDO Connector\nservices/integrations/edo-connector]
  end

  %% Data & infra
  subgraph Data_and_Infra
    pg[Container: PostgreSQL cluster\nper service schema]
    kafka[Container: Kafka broker\nevents from AsyncAPI]
    minio[Container: MinIO / Object storage]
    fabric[Container: Fabric network\norderer + peers + chaincode]
    otel[Container: OTel Collector / Prometheus / Grafana]
  end

  %% Users ‚Üí Frontends
  issuer[Issuer] --> fe_issuer
  investor[Investor] --> fe_investor
  backoffice[Backoffice] --> fe_backoffice
  broker[Broker] --> fe_broker

  %% Frontends ‚Üí Gateway
  fe_issuer -->|HTTP + OIS TS SDK| api_gw
  fe_investor --> api_gw
  fe_backoffice --> api_gw
  fe_broker --> api_gw

  %% Gateway ‚Üí Keycloak
  api_gw -->|OIDC / JWT validation| keycloak

  %% Gateway ‚Üí Domain services REST
  api_gw --> svc_issuance
  api_gw --> svc_registry
  api_gw --> svc_settlement
  api_gw --> svc_compliance
  api_gw --> svc_identity

  %% Services ‚Üí DB
  svc_issuance --> pg
  svc_registry --> pg
  svc_settlement --> pg
  svc_compliance --> pg
  svc_identity --> pg

  %% Services ‚Üí Kafka outbox
  svc_issuance -->|Outbox events| kafka
  svc_registry -->|Outbox events| kafka
  svc_settlement -->|Consume/payments| kafka
  svc_compliance -->|Audit/kyc events| kafka

  %% DLT
  svc_issuance --> svc_fabric_gw
  svc_registry --> svc_fabric_gw
  svc_settlement --> svc_fabric_gw
  svc_fabric_gw --> fabric

  %% External integrations
  svc_registry --> svc_bank
  svc_compliance --> svc_esia
  svc_compliance --> svc_edo

  svc_bank --> bank_ext[[External: Bank Core]]
  svc_esia --> esia_ext[[External: ESIA]]
  svc_edo --> edo_ext[[External: EDO]]

  %% Storage & observability
  svc_compliance --> minio
  api_gw --> otel
  svc_issuance --> otel
  svc_registry --> otel
  svc_settlement --> otel
  svc_compliance --> otel
```

---

### 1.3 C3 ‚Äî Components: Issuance & Registry NX‚Äë03 / NX‚Äë04

–≠—Ç–∏ C3-–¥–∏–∞–≥—Ä–∞–º–º—ã —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ –¥–æ–º–µ–Ω–∞—Ö, –≤–∞–∂–Ω–µ–π—à–∏—Ö –¥–ª—è NX‚Äë03 issuance endpoints + tests –∏ NX‚Äë04 registry order flow.

#### 1.3.1 C3 ‚Äî Issuance Service `services/issuance`

```mermaid
graph TB
  subgraph Issuance_Service["Issuance Service services/issuance"]
    is_api[Component: HTTP API\nProgram.cs + Minimal APIs]
    is_app[Component: IssuanceApplicationService\nIssuanceService.cs]
    is_domain[Component: Domain Model\nIssuanceId / IssuanceStatus / ValueObjects\npackages/domain]
    is_dbctx[Component: IssuanceDbContext\nIssuanceDbContext.cs]
    is_outbox_svc[Component: OutboxService\nIOutboxService + impl]
    is_outbox_bg[Component: OutboxPublisher\nBackgroundService]
    is_ledger_port[Component: ILedgerIssuance port]
    is_ledger_adp[Component: LedgerIssuanceAdapter\nHTTP ‚Üí Fabric-Gateway]
    is_metrics[Component: Metrics\nInfrastructure/Metrics.cs]
  end

  gw[Container: API Gateway] --> is_api

  %% Inside service
  is_api -->|Create/Get/Publish/Close issuance| is_app
  is_app --> is_domain
  is_app --> is_dbctx
  is_app --> is_outbox_svc
  is_app --> is_ledger_port

  is_ledger_port --> is_ledger_adp
  is_ledger_adp --> fabric_gw[Container: Fabric Gateway Service]

  is_dbctx --> pg_is[PostgreSQL DB\nschema: issuance]
  is_outbox_svc --> is_dbctx
  is_outbox_bg --> is_dbctx
  is_outbox_bg --> kafka_is[Kafka topics\nois.issuance.published / closed]

  %% Cross-service consumers
  kafka_is --> reg_svc[Container: Registry Service]
  kafka_is --> set_svc[Container: Settlement Service]

  %% Observability
  is_api --> is_metrics
  is_app --> is_metrics
```

–û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è C3‚ÜîNX:

* NX‚Äë03 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `is_api`, `is_app`, `is_dbctx`, `is_outbox_*`, `is_ledger_*` + –∏—Ö —Ç–µ—Å—Ç—ã `services/issuance/issuance.Tests`.

---

#### 1.3.2 C3 ‚Äî Registry Service `services/registry`

```mermaid
graph TB
  subgraph Registry_Service["Registry Service services/registry"]
    reg_api[Component: HTTP API\nProgram.cs orders, wallets, redeem]
    reg_app[Component: RegistryApplicationService\nRegistryService.cs]
    reg_domain[Component: Domain Model\nWallet/Holding/Order/Transaction entities]
    reg_dbctx[Component: RegistryDbContext]
    reg_outbox_svc[Component: OutboxService]
    reg_outbox_bg[Component: OutboxPublisher]
    reg_bank_port[Component: IBankNominalService port]
    reg_bank_client[Component: BankNominalClient\nHTTP ‚Üí bank adapter]
    reg_comp_port[Component: IComplianceService port]
    reg_comp_client[Component: ComplianceClient\nHTTP ‚Üí compliance]
    reg_ledger_port[Component: ILedgerRegistry port]
    reg_ledger_adp[Component: LedgerRegistryAdapter\nHTTP ‚Üí Fabric-Gateway]
  end

  gw[Container: API Gateway] --> reg_api

  %% Inside service
  reg_api -->|/v1/orders, /v1/wallets, /v1/issuances/id/redeem| reg_app
  reg_app --> reg_domain
  reg_app --> reg_dbctx
  reg_app --> reg_outbox_svc
  reg_app --> reg_bank_port
  reg_app --> reg_comp_port
  reg_app --> reg_ledger_port

  reg_bank_port --> reg_bank_client
  reg_comp_port --> reg_comp_client
  reg_ledger_port --> reg_ledger_adp

  reg_bank_client --> bank_int[Container: Bank Nominal Integration]
  reg_comp_client --> comp_svc[Container: Compliance Service]
  reg_ledger_adp --> fabric_gw[Container: Fabric Gateway Service]

  reg_dbctx --> pg_reg[PostgreSQL DB\nschema: registry]
  reg_outbox_svc --> reg_dbctx
  reg_outbox_bg --> reg_dbctx
  reg_outbox_bg --> kafka_reg[Kafka topics\norders/*, registry.*]

  kafka_reg --> set_svc[Container: Settlement Service]

```

–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ C3‚ÜîNX:

* NX‚Äë04 —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–æ–≤–Ω–æ –ø–æ —ç—Ç–æ–º—É —Ä–∞–∑—Ä–µ–∑—É: `reg_api` –º–∞—Ä—à—Ä—É—Ç—ã /orders, /redeem, `reg_app` —Å—Ç–µ–π—Ç‚Äë–º–∞—à–∏–Ω–∞ –∑–∞–∫–∞–∑–∞ create‚Üíreserve‚Üípaid, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –±–∞–Ω–∫/–∫–æ–º–ø–ª–∞–µ–Ω—Å/Fabric –∏ —Å–æ–±—ã—Ç–∏—è –≤ Kafka.

---

### 1.4 C4 ‚Äî Code/Modules: `services/issuance`

–≠—Ç–æ—Ç C4‚Äë—É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏—Ä—É–µ—Ç `services/issuance` –Ω–∞ –∫–ª–∞—Å—Å—ã/–º–æ–¥—É–ª–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –æ–Ω–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã C3. –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ `IssuanceDbContext`, DTO‚Äë–∞—Ö, Metrics, Dockerfile –∏ —Ç–µ—Å—Ç–∞—Ö.

```mermaid
graph TB
  %% Composition root
  subgraph CompositionRoot["Composition Root"]
    program["Program.cs\nDI, Minimal APIs, Auth, Metrics\nservices/issuance/Program.cs"]
  end

  %% API layer
  subgraph ApiLayer["API Layer"]
    dtoCreate["CreateIssuanceRequest\nDTO"]
    dtoResponse["IssuanceResponse\nDTO"]
    validators["FluentValidators\nCreateIssuanceRequestValidator, ... "]
  end

  %% Application layer
  subgraph AppLayer["Application Layer"]
    iIssuance["IIssuanceService"]
    issuanceSvc["IssuanceService"]
    iOutbox["IOutboxService"]
    outboxSvc["OutboxService"]
    iLedger["ILedgerIssuance"]
    ledgerAdapter["LedgerIssuanceAdapter"]
  end

  %% Domain + Persistence
  subgraph DomainAndPersistence["Domain + Persistence"]
    domainValue["OIS.Domain\nIssuanceId, IssuanceStatus,\nSecurity, value objects"]
    dbCtx["IssuanceDbContext"]
    entIssuance["IssuanceEntity\ntable: issuances"]
    entOutbox["OutboxMessage\ntable: outbox_messages"]
  end

  %% Infrastructure
  subgraph Infrastructure["Infrastructure"]
    metrics["Metrics\nrequest_duration_ms,\nrequest_errors_total"]
    outboxBg["OutboxPublisher\nBackgroundService"]
    efCore["EF Core + Npgsql provider"]
    massTransit["MassTransit Kafka rider"]
    docker["Dockerfile\nnet9.0 aspnet + sdk"]
  end

  %% External dependencies
  httpFabric["HttpClient\n‚Üí Fabric-Gateway API"]
  postgresDb["PostgreSQL DB\nissuance schema"]
  kafka["Kafka broker\nAsyncAPI topics"]

  %% Wiring
  program --> dtoCreate
  program --> dtoResponse
  program --> validators
  program --> iIssuance

  iIssuance --> issuanceSvc
  issuanceSvc --> domainValue
  issuanceSvc --> dbCtx
  issuanceSvc --> iOutbox
  issuanceSvc --> iLedger

  iOutbox --> outboxSvc
  iLedger --> ledgerAdapter

  dbCtx --> entIssuance
  dbCtx --> entOutbox
  dbCtx --> efCore

  outboxSvc --> dbCtx
  outboxBg --> dbCtx
  outboxBg --> massTransit

  ledgerAdapter --> httpFabric

  dbCtx --> postgresDb
  massTransit --> kafka

  program --> metrics
  metrics --> outboxBg
  docker --> program
```

–°–≤—è–∑—å C3‚ÜíC4:

* C3‚Äë–∫–æ–º–ø–æ–Ω–µ–Ω—Ç **HTTP API** = `Program.cs` + DTO/validators.
* **IssuanceApplicationService** = `IssuanceService` + –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IIssuanceService`.
* **Persistence** = `IssuanceDbContext` + `IssuanceEntity`/`OutboxMessage` + EF Core.
* **Ledger adapter** = `ILedgerIssuance` + `LedgerIssuanceAdapter` + HttpClient.
* **Outbox** = `IOutboxService` + `OutboxService` + `OutboxPublisher` + MassTransit/Kafka.

```

`artifacts/AlexA/project-reposcan.md`:

```md

## 2. RepoScan JSON map (–µ–¥–∏–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç)

–ù–∏–∂–µ ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä `snapshots/reposcan/ois-cfa/infra.defis.deploy.reposcan.json`, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å T/B/L‚Äë–º–æ–¥–µ–ª—å—é –∏ NX‚Äë—Å—Ö–µ–º–æ–π –∏–∑ aggregated‚Äëtalks, –Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π **–ø–æ —Ç–µ–∫—É—â–µ–º—É –¥–µ—Ä–µ–≤—É `ois-cfa`**.

### 2.1 –ö–æ—Ä–æ—Ç–∫–∞—è T/B/L‚Äë—Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–∞

| Level  | –í `ois-cfa` —Å–µ–π—á–∞—Å                                        | –ü—Ä–∏–º–µ—Ä—ã –ø—É—Ç–µ–π                                                                |
| ------ | --------------------------------------------------------- | ---------------------------------------------------------------------------- |
| Trunk  | –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã, –∫–æ–Ω—Ç–µ–∫—Å—Ç, WBS, –∫–ª—é—á–µ–≤—ã–µ ops/runbook            | `docs/context/*`, `packages/contracts/*`, `packages/domain`, `docs/deploy/*` |
| Branch | –ö–∞—Ä–∫–∞—Å —Å–µ—Ä–≤–∏—Å–æ–≤/—Ñ—Ä–æ–Ω—Ç–æ–≤/infra, –≤–µ—Ç–∫–∞ `infra.defis.deploy` | `services/*`, `apps/*`, `ops/infra/*`, `ops/gitops/*`                        |
| Leaf   | –¢–µ—Å—Ç—ã, UI‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã, —Å–∫—Ä–∏–ø—Ç—ã, NX‚Äë—Ç–∞—Å–∫–∏                     | `tests/**`, `apps/*/src/**`, `ops/scripts/*`, `tasks/NX-*.md`                |

(–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤ aggregated‚Äëtalks –∏ AGENTS/trees‚Äëleaves‚Äëdocs.)

—ç—Ç–∏ C4‚Äë–¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç **–æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å–∏—Å—Ç–µ–º—É –Ω–∞ —á–µ—Ç—ã—Ä—ë—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö**: –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º (C1), —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (C2), –≤–Ω—É—Ç—Ä—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ Issuance/Registry (C3) –∏ –¥–æ –∫–ª–∞—Å—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ `services/issuance` (C4). –û–Ω–∏ –æ–ø–∏—Ä–∞—é—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â–∏–π snapshot `infra.defis.deploy`: —Ä–µ–∞–ª—å–Ω—ã–µ Program.cs, DbContext‚Äô—ã, OpenAPI/AsyncAPI, —Ñ—Ä–æ–Ω—Ç–æ–≤—ã–π context‚Äëmap –∏ WBS‚ÄëOIS, –∞ –Ω–µ –Ω–∞ —Å—Ç–∞—Ä—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏–∑ `docs/architecture/c4` –∏–ª–∏ reposcan 11‚Äë–≥–æ —á–∏—Å–ª–∞.

–ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–∂–Ω–∏–º 2025‚Äë11‚Äë11 —Ä–µ–ø–æ—Å–∫–∞–Ω–æ–º —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –∫–æ–¥–æ–º –∏ NX‚Äë–∫–∞–Ω–æ–Ω–æ–º**: –¥–æ–º–µ–Ω—ã —Ä–æ–≤–Ω–æ —Ç–µ –∂–µ, —á—Ç–æ –≤ WBS (issuance/registry/settlement/compliance/identity), Edge‚Äë—Å–ª–æ–π ‚Äî —Ç–µ–∫—É—â–∏–π `apps/api-gateway` —Å YARP‚Äë–º–∞—Ä—à—Ä—É—Ç–∞–º–∏ –∏–∑ API/Event‚Äë–º–∞—Ç—Ä–∏—Ü—ã, —Å–µ—Ä–≤–∏—Å—ã ‚Äî —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ .NET‚Äë–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Å outbox‚ÜíKafka –∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ –∫ Fabric/–±–∞–Ω–∫—É/–ï–°–ò–ê. –°—Ç–∞—Ä—ã–π JSON –æ–ø–∏—Å—ã–≤–∞–ª ‚Äú–ø–ª–∞–Ω–∏—Ä—É–µ–º—É—é‚Äù —Å—Ç—Ä—É–∫—Ç—É—Ä—É; –Ω–æ–≤—ã–π `infra.defis.deploy.reposcan.json` ‚Äî —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ –¥–µ—Ä–µ–≤–∞, –¥–æ–º–µ–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø, —Ç–µ—Å—Ç–æ–≤ –∏ NX‚Äë—Ç–∞—Å–∫–æ–≤, –ø–ª—é—Å —è–≤–Ω–∞—è T/B/L‚Äë–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–µ–º –ø—Ä–∞–≤–∏–ª–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å –ê–ª–µ–∫—Å–µ–µ–º –æ–±—Å—É–∂–¥–∞–ª–∏ –≤ aggregated‚Äëtalks.

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏:

* –¥–ª—è **–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è NX‚Äë—Ç–∞—Å–∫–æ–≤** –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∏–ª–∏ —á–µ–ª–æ–≤–µ–∫ –±–µ—Ä—ë—Ç `logical.nx_index[NX-*]`, —Å–º–æ—Ç—Ä–∏—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ `nodes` –∏ `anchors` –∏ —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç, –∫—É–¥–∞ –ª–µ–∑—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, NX‚Äë03 ‚Üí `services/issuance` + `tests/issuance.Tests` + `openapi-issuance.yaml`; NX‚Äë04 ‚Üí `services/registry` + AsyncAPI –∏ e2e‚Äëjourneys –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞);
* –¥–ª—è **—Ä–µ–≤—å—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** –º–æ–∂–Ω–æ –∏–¥—Ç–∏ ‚Äú—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑‚Äù: C1/C2 –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –∏ –≥—Ä–∞–Ω–∏—Ü —Å–∏—Å—Ç–µ–º—ã, C3 –¥–ª—è –¥–≤—É—Ö –∫–ª—é—á–µ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤, C4 –¥–ª—è —Ç–æ—á–µ—á–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (EF‚Äë–∫–æ–Ω—Ñ–∏–≥, outbox, ledger‚Äëadapter);
* –¥–ª—è **–æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** JSON‚Äë–∫–∞—Ä—Ç–∞ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–∞—é—Ç –±—ã—Å—Ç—Ä—ã–π –º–∞—Ä—à—Ä—É—Ç: ‚Äú–≤—Å—ë –ø–æ issuance‚Äù –∏–ª–∏ ‚Äú–≤—Å—ë –ø–æ registry‚Äù –≤—ã—Ç–∞—Å–∫–∏–≤–∞–µ—Ç—Å—è –∏–∑ `logical.domains[*]`, –∞ T/B/L –∏ anchors –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Ç—Ä–æ–≥–∞—Ç—å –º–æ–∂–Ω–æ, –∫–∞–∫–∏–µ ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ NX‚Äë—Ç–∞—Å–∫–∏ –∏ review. –≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ—Ç ‚Äúmap of the territory‚Äù, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–ª–æ –≤ –ø—Ä–æ—à–ª–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.

```

`artifacts/FRONTEND-FUNCTIONALITY-ANALYSIS.md`:

```md
# üìä –ê–Ω–∞–ª–∏–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –û–ò–°

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-02  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìã –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –§–£–ù–ö–¶–ò–û–ù–ê–õ–£ (—Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–æ–º–ø—Ç–∞–º)

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –û–ò–° (259-–§–ó, 746-–ü):

1. **–í—ã–ø—É—Å–∫ –¶–§–ê** (—ç–º–∏—Å—Å–∏—è)
2. **–û–±—Ä–∞—â–µ–Ω–∏–µ –¶–§–ê** (–ø–µ—Ä–µ–¥–∞—á–∞, –ø–æ–∫—É–ø–∫–∞)
3. **–ü–æ–≥–∞—à–µ–Ω–∏–µ –¶–§–ê**
4. **–í—ã–ø–ª–∞—Ç—ã** (–ø—Ä–æ—Ü–µ–Ω—Ç—ã, –¥–∏–≤–∏–¥–µ–Ω–¥—ã)
5. **–†–µ–µ—Å—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (5625-–£)
6. **KYC/AML –ø—Ä–æ–≤–µ—Ä–∫–∏**
7. **–ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤** (5635-–£)
8. **–ê—É–¥–∏—Ç –∏ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**
9. **–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**
10. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã**

---

## üè¢ PORTAL ISSUER (–ü–æ—Ä—Ç–∞–ª —ç–º–∏—Ç–µ–Ω—Ç–∞)

### ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û:

1. **Dashboard** (`/dashboard`)
   - –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ (Active Issuances, Total Amount, Investors)
   - ‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (hardcoded "-")

2. **–°–ø–∏—Å–æ–∫ –≤—ã–ø—É—Å–∫–æ–≤** (`/issuances`)
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - ‚ö†Ô∏è API endpoint –¥–ª—è —Å–ø–∏—Å–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (TODO –≤ –∫–æ–¥–µ)
   - –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã–ø—É—Å–∫–∞

3. **–°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø—É—Å–∫–∞** (`/issuances/create`)
   - –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (Zod)
   - –ü–æ–ª—è: assetId, issuerId, totalAmount, nominal, issueDate, maturityDate
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

4. **–î–µ—Ç–∞–ª–∏ –≤—ã–ø—É—Å–∫–∞** (`/issuances/[id]`)
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π
   - –ö–Ω–æ–ø–∫–∏ Publish/Close (—Ä–∞–±–æ—Ç–∞—é—Ç)
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

5. **–û—Ç—á–µ—Ç—ã** (`/reports`)
   - ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∞ ("Reports functionality coming soon...")

### ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢:

#### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø—É—Å–∫–∞–º–∏
- ‚ùå –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ –≤—ã–ø—É—Å–∫–∞
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –≤—ã–ø–ª–∞—Ç (schedule)
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—ã–ø—É—Å–∫–∞
- ‚ùå –î–æ–∫—É–º–µ–Ω—Ç—ã –≤—ã–ø—É—Å–∫–∞ (–∑–∞–≥—Ä—É–∑–∫–∞/–ø—Ä–æ—Å–º–æ—Ç—Ä)
- ‚ùå –ü—É–±–ª–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤)

#### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚ùå –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—ã–ø—É—Å–∫–∞–º (–∞–∫—Ç–∏–≤–Ω—ã–µ/–∑–∞–∫—Ä—ã—Ç—ã–µ)
- ‚ùå –ì—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–¥–∞–∂
- ‚ùå –°–ø–∏—Å–æ–∫ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ –ø–æ –≤—ã–ø—É—Å–∫—É
- ‚ùå –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫—É–ø–æ–∫

#### 3. –û—Ç—á–µ—Ç—ã (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- ‚ùå –û—Ç—á–µ—Ç –ø–æ –≤—ã–ø—É—Å–∫–∞–º
- ‚ùå –û—Ç—á–µ—Ç –ø–æ –≤—ã–ø–ª–∞—Ç–∞–º
- ‚ùå –û—Ç—á–µ—Ç –ø–æ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º
- ‚ùå –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å (–¥–ª—è –¶–ë)
- ‚ùå –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel/PDF

#### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∞–º–∏
- ‚ùå –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–æ–≤ (assets)
- ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤
- ‚ùå –°–≤—è–∑—å –∞–∫—Ç–∏–≤–æ–≤ —Å –≤—ã–ø—É—Å–∫–∞–º–∏

#### 5. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùå –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### 6. –ü—Ä–æ—Ñ–∏–ª—å —ç–º–∏—Ç–µ–Ω—Ç–∞
- ‚ùå –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –∫–æ–º–ø–∞–Ω–∏–∏
- ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚ùå API –∫–ª—é—á–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)

---

## üíº PORTAL INVESTOR (–ü–æ—Ä—Ç–∞–ª –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞)

### ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û:

1. **–ü–æ—Ä—Ç—Ñ–µ–ª—å** (`/portfolio`)
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ö–æ–ª–¥–∏–Ω–≥–æ–≤ (holdings)
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

2. **–ü–æ–∫—É–ø–∫–∞ –¶–§–ê** (`/orders/new`)
   - –§–æ—Ä–º–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
   - –ü–æ–ª—è: issuanceId, amount
   - Idempotency-Key –ø–æ–¥–¥–µ—Ä–∂–∫–∞
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

3. **–ò—Å—Ç–æ—Ä–∏—è** (`/history`)
   - ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∞ ("History coming soon...")

### ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢:

#### 1. –ö–∞—Ç–∞–ª–æ–≥ –¶–§–ê
- ‚ùå –ö–∞—Ç–∞–ª–æ–≥ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—ã–ø—É—Å–∫–æ–≤
- ‚ùå –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
- ‚ùå –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø—É—Å–∫–µ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
- ‚ùå –ì—Ä–∞—Ñ–∏–∫–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- ‚ùå –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã–ø—É—Å–∫–æ–≤

#### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º
- ‚ùå –î–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ö–æ–ª–¥–∏–Ω–≥—É
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –∞–∫—Ç–∏–≤—É
- ‚ùå –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- ‚ùå –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è

#### 3. –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø–æ–≥–∞—à–µ–Ω–∏–π
- ‚ùå –§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫
- ‚ùå –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏

#### 4. –í—ã–ø–ª–∞—Ç—ã
- ‚ùå –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç
- ‚ùå –î–µ—Ç–∞–ª–∏ –≤—ã–ø–ª–∞—Ç
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–ø–ª–∞—Ç–∞—Ö

#### 5. –ü–æ–≥–∞—à–µ–Ω–∏–µ
- ‚ùå –ó–∞—è–≤–∫–∞ –Ω–∞ –ø–æ–≥–∞—à–µ–Ω–∏–µ
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø–æ–≥–∞—à–µ–Ω–∏–π
- ‚ùå –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–æ–∫

#### 6. –î–æ–∫—É–º–µ–Ω—Ç—ã
- ‚ùå –î–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –≤—ã–ø—É—Å–∫–æ–≤
- ‚ùå –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- ‚ùå –î–æ–≥–æ–≤–æ—Ä—ã

#### 7. –ü—Ä–æ—Ñ–∏–ª—å –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞
- ‚ùå –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚ùå –°—Ç–∞—Ç—É—Å KYC (–ø—Ä–æ—Å–º–æ—Ç—Ä)
- ‚ùå –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ (–ø—Ä–æ—Å–º–æ—Ç—Ä)
- ‚ùå –õ–∏–º–∏—Ç—ã –ø–æ–∫—É–ø–æ–∫
- ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### 8. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùå –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–ø–ª–∞—Ç–∞—Ö
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –≤—ã–ø—É—Å–∫–∞—Ö
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–≥–∞—à–µ–Ω–∏—è—Ö

---

## üõ†Ô∏è BACKOFFICE (–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)

### ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û:

1. **KYC Management** (`/kyc`)
   - –ü–æ–∏—Å–∫ –ø–æ Investor ID
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ KYC
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - ‚ö†Ô∏è –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π approve/reject/update

2. **Payouts** (`/payouts`)
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞ –ø–æ –≤—ã–ø–ª–∞—Ç–∞–º
   - –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ settlement
   - –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

3. **Qualification** (`/qualification`)
   - ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∞ ("Qualification management coming soon...")

4. **Audit** (`/audit`)
   - ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∞ ("Audit log coming soon...")

### ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢:

#### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (5625-–£)
- ‚ùå –†–µ–µ—Å—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚ùå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏
- ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 2. KYC/AML (–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ)
- ‚ùå –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ –Ω–∞ KYC
- ‚ùå –î–µ—Ç–∞–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ùå Approve/Reject —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å watchlists
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫

#### 3. –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ (5635-–£)
- ‚ùå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π/–Ω–µ–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞–º–∏
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚ùå –û—Ç—á–µ—Ç—ã –ø–æ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### 4. –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- ‚ùå –ü—Ä–æ—Å–º–æ—Ç—Ä –∂—É—Ä–Ω–∞–ª–∞ –∞—É–¥–∏—Ç–∞
- ‚ùå –§–∏–ª—å—Ç—Ä—ã (–ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –¥–µ–π—Å—Ç–≤–∏—é, –¥–∞—Ç–µ, —Ç–∏–ø—É)
- ‚ùå –ü–æ–∏—Å–∫
- ‚ùå –≠–∫—Å–ø–æ—Ä—Ç –∂—É—Ä–Ω–∞–ª–∞
- ‚ùå –î–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)

#### 5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø—É—Å–∫–∞–º–∏
- ‚ùå –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤—ã–ø—É—Å–∫–æ–≤ (–≤—Å–µ—Ö —ç–º–∏—Ç–µ–Ω—Ç–æ–≤)
- ‚ùå –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π
- ‚ùå –ú–æ–¥–µ—Ä–∞—Ü–∏—è –≤—ã–ø—É—Å–∫–æ–≤
- ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–ø—É—Å–∫–æ–≤

#### 6. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–ª–∞—Ç–∞–º–∏
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –≤—ã–ø–ª–∞—Ç
- ‚ùå –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –≤—ã–ø–ª–∞—Ç
- ‚ùå –û—Ç–º–µ–Ω–∞ –≤—ã–ø–ª–∞—Ç
- ‚ùå –î–µ—Ç–∞–ª–∏ batch –≤—ã–ø–ª–∞—Ç
- ‚ùå –ü—Ä–∏–º–∏—Ä–µ–Ω–∏–µ (reconciliation)

#### 7. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
- ‚ùå Dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚ùå –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚ùå –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- ‚ùå –ê–ª–µ—Ä—Ç—ã –∏ –æ—à–∏–±–∫–∏
- ‚ùå –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### 8. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∞–º–∏
- ‚ùå –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤
- ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ùå –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–æ–≤

#### 9. –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- ‚ùå –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è –¶–ë
- ‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –æ—Ç—á–µ—Ç–æ–≤

#### 10. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞–º–∏/–∫–æ–º–∏—Å—Å–∏—è–º–∏
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞–º–∏

#### 11. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∂–∞–ª–æ–±
- ‚ùå –°–ø–∏—Å–æ–∫ –∂–∞–ª–æ–± (complaints)
- ‚ùå –î–µ—Ç–∞–ª–∏ –∂–∞–ª–æ–±—ã
- ‚ùå –û–±—Ä–∞–±–æ—Ç–∫–∞ –∂–∞–ª–æ–±
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üîê –û–ë–©–ò–ï –û–¢–°–£–¢–°–¢–í–£–Æ–©–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Keycloak (–µ—Å—Ç—å)
- ‚ùå –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
- ‚ùå –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–±—â–µ–µ)
- ‚ùå –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–µ–¥–∏–Ω—ã–π –¥–ª—è –≤—Å–µ—Ö –ø–æ—Ä—Ç–∞–ª–æ–≤)
- ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (email/SMS/push)
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 3. –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç
- ‚ùå –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ùå –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ùå –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–≠–ü)
- ‚ùå –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùå –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (–ï–°–ò–ê, –±–∞–Ω–∫, –≠–î–û)
- ‚ùå –õ–æ–≥–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- ‚ùå –†—É—á–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### 5. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚ùå –û —Å–∏—Å—Ç–µ–º–µ
- ‚ùå –î–æ–∫—É–º–µ–Ω—Ç—ã (–ø—É–±–ª–∏—á–Ω—ã–µ)
- ‚ùå –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)
- ‚ùå –ö–æ–Ω—Ç–∞–∫—Ç—ã

### 6. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (i18n)
- ‚ùå –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤
- ‚ùå –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞

### 7. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (WCAG AA)
- ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ WCAG AA
- ‚ùå Screen reader –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚ùå Keyboard navigation

---

## üìä –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (MVP –¥–ª—è –û–ò–°):

1. **Portal Issuer:**
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/–ø—É–±–ª–∏–∫–∞—Ü–∏—è/–∑–∞–∫—Ä—ã—Ç–∏–µ –≤—ã–ø—É—Å–∫–æ–≤ (–±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –µ—Å—Ç—å)
   - ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –≤—ã–ø–ª–∞—Ç
   - ‚ùå –û—Ç—á–µ—Ç—ã (—Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ)

2. **Portal Investor:**
   - ‚úÖ –ü–æ–∫—É–ø–∫–∞ –¶–§–ê (–±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –µ—Å—Ç—å)
   - ‚ùå –ö–∞—Ç–∞–ª–æ–≥ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—ã–ø—É—Å–∫–æ–≤
   - ‚ùå –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
   - ‚ùå –í—ã–ø–ª–∞—Ç—ã –∏ –ø–æ–≥–∞—à–µ–Ω–∏—è

3. **Backoffice:**
   - ‚ö†Ô∏è KYC (—á–∞—Å—Ç–∏—á–Ω–æ - –Ω—É–∂–Ω—ã approve/reject)
   - ‚ùå –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
   - ‚ùå –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
   - ‚ùå –†–µ–µ—Å—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (5625-–£)

### üü° –í–ê–ñ–ù–û (–¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –û–ò–°):

1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–≤—Å–µ –ø–æ—Ä—Ç–∞–ª—ã)
2. –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç
3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å (—Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω–∞—è)

### üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û (–¥–ª—è production):

1. i18n
2. WCAG AA
3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
4. –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

1. **–ù–∞—á–∞—Ç—å —Å –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
   - –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ (backoffice)
   - –ö–∞—Ç–∞–ª–æ–≥ –¶–§–ê (investor)
   - –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π (investor)
   - –û—Ç—á–µ—Ç—ã (issuer)
   - –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ KYC (backoffice)

2. **–î–æ–±–∞–≤–∏—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –ø–æ–∏—Å–∫–∞

3. **–£–ª—É—á—à–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
   - Dashboard —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - –°–ø–∏—Å–æ–∫ –≤—ã–ø—É—Å–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
   - –î–µ—Ç–∞–ª–∏ —Ö–æ–ª–¥–∏–Ω–≥–æ–≤

---

**–ò—Ç–æ–≥–æ:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ~30% –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –û–ò–° –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –µ—â–µ ~70% —Ñ—É–Ω–∫—Ü–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –æ–±–ª–∞—Å—Ç–∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏, –∞—É–¥–∏—Ç–∞, –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞ –∏ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.


```

`artifacts/FRONTEND-STARTUP.md`:

```md
# Frontend Applications - Startup Guide

## URLs

### Development Servers
- **Portal Issuer**: http://localhost:3001
- **Portal Investor**: http://localhost:3002
- **Backoffice**: http://localhost:3003

### Backend Services
- **API Gateway**: http://localhost:5000
- **Keycloak**: http://localhost:8080

---

## Quick Start

### 1. Install Dependencies

```bash
# Install all frontend dependencies
cd apps/portal-issuer && npm install
cd ../portal-investor && npm install
cd ../backoffice && npm install

# Install E2E test dependencies
cd ../../tests/e2e && npm install

# Generate SDKs (optional, if needed)
cd ../../packages/sdks/ts && npm install && npm run generate
```

### 2. Start Backend Services

```bash
docker-compose up -d
```

### 3. Setup Keycloak

–°–º. `KEYCLOAK-SETUP.md` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ realm, clients –∏ users.

**Quick setup:**
1. Go to http://localhost:8080 (admin/admin)
2. Create realm `ois-dev`
3. Create clients: `portal-issuer`, `portal-investor`, `backoffice`
4. Create roles: `issuer`, `investor`, `admin`
5. Create test users —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ä–æ–ª—è–º–∏

### 4. Start Frontend Apps

**Terminal 1:**
```bash
cd apps/portal-issuer
npm run dev
```

**Terminal 2:**
```bash
cd apps/portal-investor
npm run dev
```

**Terminal 3:**
```bash
cd apps/backoffice
npm run dev
```

---

## Test Credentials (Keycloak)

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤ Keycloak:

- **Issuer**: `issuer@test.com` / `password123` (role: issuer)
- **Investor**: `investor@test.com` / `password123` (role: investor)
- **Admin**: `admin@test.com` / `password123` (roles: admin, backoffice)

---

## E2E Testing

```bash
# Run tests
make e2e

# Run with UI
make e2e-ui

# View report
cd tests/e2e && npx playwright show-report
```

---

## Troubleshooting

1. **Keycloak connection errors**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Keycloak –∑–∞–ø—É—â–µ–Ω –∏ realm –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. **CORS errors**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API Gateway –∑–∞–ø—É—â–µ–Ω –∏ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
3. **SDK errors**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run generate` –≤ `packages/sdks/ts`


```

`artifacts/KEYCLOAK-SETUP-GUIDE.md`:

```md
# üîß Keycloak Setup Guide - –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## üìã –°—Ç–∞—Ç—É—Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

‚úÖ **Keycloak —Ä–∞–±–æ—Ç–∞–µ—Ç** –Ω–∞ http://localhost:8080  
‚úÖ **–§—Ä–æ–Ω—Ç–µ–Ω–¥—ã –∑–∞–ø—É—â–µ–Ω—ã** –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 3001, 3002, 3003  
‚úÖ **.env.local —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π  
‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ Keycloak Admin Console**

---

## üö® –ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞:** `invalid_redirect_uri`  
**–ü—Ä–∏—á–∏–Ω–∞:** NextAuth –Ω–µ –∑–Ω–∞–µ—Ç, –Ω–∞ –∫–∞–∫–æ–º –ø–æ—Ä—Ç—É —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ –±—ã–ª–∞ –∑–∞–¥–∞–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NEXTAUTH_URL`.

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –°–æ–∑–¥–∞–Ω—ã `.env.local` —Ñ–∞–π–ª—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ `NEXTAUTH_URL`.

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ Keycloak Admin Console

### –®–∞–≥ 1: –í–æ–π—Ç–∏ –≤ Admin Console

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://localhost:8080/admin
2. –í–≤–µ–¥–∏—Ç–µ:
   - **Username:** `admin`
   - **Password:** `admin`

### –®–∞–≥ 2: –í—ã–±—Ä–∞—Ç—å Realm

- –í –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –≤—ã–±–µ—Ä–∏—Ç–µ realm: **ois-dev**

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ Backoffice

1. **Clients** ‚Üí –Ω–∞–π–¥–∏—Ç–µ `backoffice` ‚Üí –∫–ª–∏–∫–Ω–∏—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Settings**
3. –í –ø–æ–ª–µ **Valid Redirect URIs** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3003/api/auth/callback/keycloak
   ```
4. –í –ø–æ–ª–µ **Web Origins** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3003
   ```
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
   - ‚úÖ **Access Type:** `confidential`
   - ‚úÖ **Standard Flow Enabled:** `ON`
6. **Save**

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ Portal Issuer

1. **Clients** ‚Üí –Ω–∞–π–¥–∏—Ç–µ `portal-issuer` ‚Üí –∫–ª–∏–∫–Ω–∏—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Settings**
3. –í –ø–æ–ª–µ **Valid Redirect URIs** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3001/api/auth/callback/keycloak
   ```
4. –í –ø–æ–ª–µ **Web Origins** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3001
   ```
5. **Save**

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ Portal Investor

1. **Clients** ‚Üí –Ω–∞–π–¥–∏—Ç–µ `portal-investor` ‚Üí –∫–ª–∏–∫–Ω–∏—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Settings**
3. –í –ø–æ–ª–µ **Valid Redirect URIs** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3002/api/auth/callback/keycloak
   ```
4. –í –ø–æ–ª–µ **Web Origins** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3002
   ```
5. **Save**

---

## üë§ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –í realm `ois-dev` ‚Üí **Users** ‚Üí **Add user**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Username:** `test-user`
   - **Email:** `test@example.com`
   - **Email Verified:** `ON`
   - **First Name:** `Test`
   - **Last Name:** `User`
3. **Save**
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Credentials**
5. –ù–∞–∂–º–∏—Ç–µ **Set password**
6. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Password:** `test123`
   - **Password Confirmation:** `test123`
   - **Temporary:** `OFF` (—á—Ç–æ–±—ã –Ω–µ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å —Å–º–µ–Ω—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ)
7. **Save**

---

## üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ã

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `.env.local` —Ñ–∞–π–ª–æ–≤ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ã, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏–ª–∏ –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:
```bash
# –ù–∞–∂–º–∏—Ç–µ Ctrl+C –≤ –∫–∞–∂–¥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å –∑–∞–ø—É—â–µ–Ω–Ω—ã–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ:

**Terminal 1 - Backoffice:**
```bash
cd apps/backoffice
npm run dev
```

**Terminal 2 - Portal Issuer:**
```bash
cd apps/portal-issuer
npm run dev
```

**Terminal 3 - Portal Investor:**
```bash
cd apps/portal-investor
npm run dev
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3003 (Backoffice)
2. –ù–∞–∂–º–∏—Ç–µ **"Sign in with Keycloak"**
3. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ Keycloak (http://localhost:8080)
4. –í–æ–π–¥–∏—Ç–µ —Å `test-user` / `test123`
5. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ http://localhost:3003 —Å —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

---

## üîç –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Keycloak:
```bash
docker logs ois-keycloak --tail 50 | Select-String "redirect"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ .env.local —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ:
```bash
# Backoffice
Get-Content apps\backoffice\.env.local

# Portal Issuer
Get-Content apps\portal-issuer\.env.local

# Portal Investor
Get-Content apps\portal-investor\.env.local
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ã –∑–∞–ø—É—â–µ–Ω—ã:
```bash
Get-NetTCPConnection -LocalPort 3001,3002,3003 -ErrorAction SilentlyContinue | Select-Object LocalPort, State
```

---

## üìù –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

‚úÖ –°–æ–∑–¥–∞–Ω—ã `.env.local` —Ñ–∞–π–ª—ã –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–µ—Ö —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤:
- `apps/backoffice/.env.local` ‚Üí `NEXTAUTH_URL=http://localhost:3003`
- `apps/portal-issuer/.env.local` ‚Üí `NEXTAUTH_URL=http://localhost:3001`
- `apps/portal-investor/.env.local` ‚Üí `NEXTAUTH_URL=http://localhost:3002`

‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Keycloak Admin Console** (—Å–º. –≤—ã—à–µ)

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å!** üéâ


```

`artifacts/KEYCLOAK-SETUP.md`:

```md
# Keycloak Setup for Local Development

## ‚úÖ Quick Start

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–í–ê–ñ–ù–û!)

Keycloak —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –°–æ–∑–¥–∞–π—Ç–µ –µ—ë –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:

```bash
docker exec ois-postgres psql -U ois -d postgres -c "CREATE DATABASE keycloak;"
```

### 2. –ó–∞–ø—É—Å–∫ Keycloak

```bash
docker-compose up -d keycloak
```

**–í–∞–∂–Ω–æ:** –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –ë–î (—Å–æ–∑–¥–∞–Ω–∏–µ 94+ —Ç–∞–±–ª–∏—Ü).

### 3. –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ

- **URL:** http://localhost:8080/admin
- **Username:** `admin`
- **Password:** `admin`

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
```bash
# Health check
curl http://localhost:8080/health/ready

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
http://localhost:8080/admin
```

## Create Realm: `ois-dev`

1. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É, –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤–≤–µ—Ä—Ö—É —Å–ª–µ–≤–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Master")
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Create Realm"**
3. Name: `ois-dev`
4. **Save**

## Create Clients

### portal-issuer
1. –í realm `ois-dev`, –ø–µ—Ä–µ–π–¥–∏—Ç–µ: **Clients** ‚Üí **Create Client**
2. Client ID: `portal-issuer`
3. Client Protocol: `openid-connect`
4. **Next**
5. Access Type: `public`
6. Valid Redirect URIs: `http://localhost:3001/*`
7. Web Origins: `http://localhost:3001`
8. **Save**

### portal-investor
1. Clients ‚Üí Create Client
2. Client ID: `portal-investor`
3. Client Protocol: `openid-connect`
4. **Next**
5. Access Type: `public`
6. Valid Redirect URIs: `http://localhost:3002/*`
7. Web Origins: `http://localhost:3002`
8. **Save**

### backoffice
1. Clients ‚Üí Create Client
2. Client ID: `backoffice`
3. Client Protocol: `openid-connect`
4. **Next**
5. Access Type: `public`
6. Valid Redirect URIs: `http://localhost:3003/*`
7. Web Origins: `http://localhost:3003`
8. **Save**

## Create Roles

1. –í realm `ois-dev`, –ø–µ—Ä–µ–π–¥–∏—Ç–µ: **Realm Roles** ‚Üí **Create Role**
2. –°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–æ–ª–∏ (–ø–æ –æ–¥–Ω–æ–π):
   - `issuer`
   - `investor`
   - `admin`
   - `backoffice`

## Create Test Users

### Issuer User
1. **Users** ‚Üí **Create User**
2. Username: `issuer@test.com`
3. Email: `issuer@test.com`
4. Email Verified: `ON`
5. **Create**
6. –í–∫–ª–∞–¥–∫–∞ **Credentials**:
   - Password: `password123`
   - Password Confirmation: `password123`
   - Temporary: `OFF`
   - **Save**
7. –í–∫–ª–∞–¥–∫–∞ **Role Mappings**:
   - Assign role: `issuer`
   - **Assign**

### Investor User
1. Users ‚Üí Create User
2. Username: `investor@test.com`
3. Email: `investor@test.com`
4. Email Verified: `ON`
5. Create
6. Credentials: Password `password123`, Temporary: OFF
7. Role Mappings: Assign role `investor`

### Admin User
1. Users ‚Üí Create User
2. Username: `admin@test.com`
3. Email: `admin@test.com`
4. Email Verified: `ON`
5. Create
6. Credentials: Password `password123`, Temporary: OFF
7. Role Mappings: Assign roles `admin` –∏ `backoffice`

## Troubleshooting

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```bash
docker exec ois-postgres psql -U ois -d postgres -c "CREATE DATABASE keycloak;"
docker-compose restart keycloak
```

### Keycloak –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker logs ois-keycloak --tail 50

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker ps --filter "name=keycloak"
```

### –ù–µ –º–æ–≥—É –∑–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL: http://localhost:8080/admin (–Ω–µ –ø—Ä–æ—Å—Ç–æ /)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker ps`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health: `curl http://localhost:8080/health/ready`

---

**Note:** –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –∏ HTTPS.

```

`artifacts/OBSERVABILITY-SECURITY-ACCESS.md`:

```md
# Observability & Security - Access Information

## üìä Grafana

**URL:** http://localhost:3000  
**Username:** `admin`  
**Password:** `admin`

**Note:** –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ Grafana –ø–æ–ø—Ä–æ—Å–∏—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å.

**Dashboards:**
- OIS - API Latency & RPS
- OIS - Payouts Throughput

## üìà Prometheus

**URL:** http://localhost:9090  
**No authentication** (dev mode)

**Scrape targets:**
- api-gateway:8080/metrics
- issuance-service:8080/metrics
- registry-service:8080/metrics
- settlement-service:8080/metrics
- compliance-service:8080/metrics
- identity-service:8080/metrics
- bank-nominal:8080/metrics

## üîí Security Features

### Rate Limiting
- **Token Bucket:** 100 tokens, replenish 10/sec
- **Response:** 429 Too Many Requests
- **Logging:** Rejected requests logged with IP and reason

### Request Size Limits
- **Max size:** 10 MB
- **Rejection:** 413 Payload Too Large

### Security Headers
–í—Å–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç API Gateway –≤–∫–ª—é—á–∞—é—Ç:
- `X-Content-Type-Options: nosniff`
- `X-Frame-Options: DENY`
- `X-XSS-Protection: 1; mode=block`
- `Referrer-Policy: strict-origin-when-cross-origin`
- `Content-Security-Policy: default-src 'self'`

### CORS
**Allowed Origins:**
- http://localhost:3001 (portal-issuer)
- http://localhost:3002 (portal-investor)
- http://localhost:3003 (backoffice)

## üîç Monitoring Queries

### Request Rate
```promql
rate(http_server_request_duration_seconds_count[5m])
```

### P95 Latency
```promql
histogram_quantile(0.95, rate(http_server_request_duration_seconds_bucket[5m]))
```

### Error Rate
```promql
rate(http_server_request_duration_seconds_count{status_code=~"5.."}[5m])
```

## üíæ Backups

**Location:** `./backups/ois_backup_YYYYMMDD_HHMMSS.sql.gz`

**Scheduled:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ (—á–µ—Ä–µ–∑ docker-compose postgres-backup service)

**Retention:** 7 –¥–Ω–µ–π

**Manual backup:**
```bash
./ops/scripts/backup.sh
```

**Restore:**
```bash
# See ops/scripts/restore.md for details
gunzip < backups/ois_backup_*.sql.gz | \
  PGPASSWORD=ois_dev_password psql -h localhost -U ois -d ois
```


```

`artifacts/gateway-routing-report.md`:

```md
# API Gateway Routing Report

**Generated:** 2025-01-27  
**Re-checked:** 2025-11-18 (infra.defis.deploy, NX-02 v2)  
**Task:** NX-02 Gateway Routing and Health

## Executive Summary

API Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **YARP (Yet Another Reverse Proxy)** –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ backend —Å–µ—Ä–≤–∏—Å–∞–º. –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∏–º–µ—é—Ç `/health` –∏ `/metrics` endpoints. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ `apps/api-gateway/appsettings.json`.

## YARP Routing Configuration

### Routes (Gateway ‚Üí Services)

| Gateway Path | Cluster | Service | Service Address | Transform | Status |
|--------------|---------|---------|----------------|-----------|--------|
| `/issuances/{**catch-all}` | `issuance` | Issuance | `http://issuance-service:8080` | `/v1/issuances/{**catch-all}` | ‚úÖ |
| `/v1/orders/{**catch-all}` | `registry` | Registry | `http://registry-service:8080` | `/v1/orders/{**catch-all}` | ‚úÖ |
| `/v1/wallets/{**catch-all}` | `registry` | Registry | `http://registry-service:8080` | `/v1/wallets/{**catch-all}` | ‚úÖ |
| `/v1/issuances/{**catch-all}/redeem` | `registry` | Registry | `http://registry-service:8080` | `/v1/issuances/{**catch-all}/redeem` | ‚úÖ |
| `/v1/settlement/{**catch-all}` | `settlement` | Settlement | `http://settlement-service:8080` | `/v1/settlement/{**catch-all}` | ‚úÖ |
| `/v1/reports/{**catch-all}` | `settlement` | Settlement | `http://settlement-service:8080` | `/v1/reports/{**catch-all}` | ‚úÖ |
| `/v1/compliance/{**catch-all}` | `compliance` | Compliance | `http://compliance-service:8080` | `/v1/compliance/{**catch-all}` | ‚úÖ |
| `/v1/complaints/{**catch-all}` | `compliance` | Compliance | `http://compliance-service:8080` | `/v1/complaints/{**catch-all}` | ‚úÖ |
| `/identity/{**catch-all}` | `identity` | Identity | `http://identity-service:8080` | `/identity/{**catch-all}` | ‚úÖ |

### Endpoint Mapping (OpenAPI Gateway ‚Üí YARP Routes)

| OpenAPI Endpoint | Method | YARP Route | Service Endpoint | Verified |
|------------------|--------|------------|-----------------|----------|
| `/health` | GET | Direct (Gateway) | `/health` | ‚úÖ |
| `/issuances` | POST | `issuances` | `/v1/issuances` | ‚úÖ |
| `/issuances/{id}` | GET | `issuances` | `/v1/issuances/{id}` | ‚úÖ |
| `/issuances/{id}/publish` | POST | `issuances` | `/v1/issuances/{id}/publish` | ‚úÖ |
| `/issuances/{id}/close` | POST | `issuances` | `/v1/issuances/{id}/close` | ‚úÖ |
| `/v1/issuances/{id}/redeem` | POST | `redeem` | `/v1/issuances/{id}/redeem` | ‚úÖ |
| `/v1/orders` | POST | `orders` | `/v1/orders` | ‚úÖ |
| `/orders/{id}` | GET | `orders` | `/v1/orders/{id}` | ‚ö†Ô∏è |
| `/v1/wallets/{investorId}` | GET | `wallets` | `/v1/wallets/{investorId}` | ‚úÖ |
| `/v1/settlement/run` | POST | `settlement` | `/v1/settlement/run` | ‚úÖ |
| `/v1/reports/payouts` | GET | `reports` | `/v1/reports/payouts` | ‚úÖ |
| `/v1/compliance/kyc/check` | POST | `compliance` | `/v1/compliance/kyc/check` | ‚úÖ |
| `/v1/compliance/qualification/evaluate` | POST | `compliance` | `/v1/compliance/qualification/evaluate` | ‚úÖ |
| `/v1/compliance/investors/{id}/status` | GET | `compliance` | `/v1/compliance/investors/{id}/status` | ‚úÖ |
| `/v1/complaints` | POST | `complaints` | `/v1/complaints` | ‚úÖ |

**‚ö†Ô∏è SPEC DIFF**: Gateway OpenAPI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `/orders/{id}` –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ `/v1`, –Ω–æ YARP –º–∞—Ä—à—Ä—É—Ç `orders` –æ–∂–∏–¥–∞–µ—Ç `/v1/orders/{**catch-all}`. –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏–±–æ –æ–±–Ω–æ–≤–∏—Ç—å OpenAPI, –ª–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç.

## Health & Metrics Status

### Services Health Endpoints

| Service | Health Endpoint | Metrics Endpoint | Status | Notes |
|---------|----------------|------------------|--------|-------|
| API Gateway | `/health` | ‚Äî | ‚úÖ | `apps/api-gateway/Program.cs:99` |
| Identity | `/health` | ‚Äî | ‚úÖ | `services/identity/Program.cs:25` |
| Issuance | `/health` | `/metrics` | ‚úÖ | `services/issuance/Program.cs:139-140` |
| Registry | `/health` | `/metrics` | ‚úÖ | `services/registry/Program.cs:167-168` |
| Settlement | `/health` | `/metrics` | ‚úÖ | `services/settlement/Program.cs:136-137` |
| Compliance | `/health` | `/metrics` | ‚úÖ | `services/compliance/Program.cs:145-146` |
| Bank Nominal | `/health` | ‚Äî | ‚úÖ | `services/integrations/bank-nominal/Program.cs:19` |
| ESIA Adapter | `/health` | ‚Äî | ‚úÖ | (README mentions it) |

### Health Checks Implementation

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
- `AddHealthChecks()` —Å `AddDbContextCheck<T>()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î
- `MapHealthChecks("/health")` –¥–ª—è endpoint
- `MapPrometheusScrapingEndpoint("/metrics")` –¥–ª—è –º–µ—Ç—Ä–∏–∫ (Issuance, Registry, Settlement, Compliance)

## Local Development Ports

| Service | HTTP Port | HTTPS Port | Notes |
|---------|-----------|------------|-------|
| API Gateway | 53985 | 53977 | `apps/api-gateway/Properties/launchSettings.json` |
| Identity | 53987 | 53981 | `services/identity/Properties/launchSettings.json` |
| Issuance | 53983 | 53978 | `services/issuance/Properties/launchSettings.json` |
| Registry | 53988 | 53980 | `services/registry/Properties/launchSettings.json` |
| Settlement | ‚Äî | ‚Äî | (check docker-compose or appsettings) |
| Compliance | 53986 | 53979 | `services/compliance/Properties/launchSettings.json` |

**Note**: –í docker-compose –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥—Ä—É–≥–∏–µ –ø–æ—Ä—Ç—ã (5000-5008). –°–º. `docker-compose.yml`.

## Recommendations

1. **–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å—ã**: Gateway OpenAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/issuances` –±–µ–∑ `/v1`, –Ω–æ —Å–µ—Ä–≤–∏—Å—ã –æ–∂–∏–¥–∞—é—Ç `/v1/issuances`. YARP —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ—Ç—Ä–∞–∂–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å Gateway.

2. **–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –¥–ª—è `/orders/{id}`**: –õ–∏–±–æ –æ–±–Ω–æ–≤–∏—Ç—å OpenAPI –Ω–∞ `/v1/orders/{id}`, –ª–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π YARP –º–∞—Ä—à—Ä—É—Ç.

3. **–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Gateway**: –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ Prometheus –º–µ—Ç—Ä–∏–∫ –≤ Gateway –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∫—Å–∏—Ä—É–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

4. **Health check –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**: ESIA Adapter –∏ EDO Connector –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —è–≤–Ω—ã–µ health endpoints.

## Verification Commands

```bash
# Check all services health (requires docker-compose stack running)
make check-health

# Check individual service (example)
curl -sf http://localhost:5000/health && echo "Gateway: OK" || echo "Gateway: FAILED"

# Check metrics
curl -sf http://localhost:5002/metrics | head -20

# Test routing through Gateway
curl -X POST http://localhost:5000/issuances \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"assetId":"...","issuerId":"..."}'
```

## References

- YARP Configuration: `apps/api-gateway/appsettings.json`
- Gateway Code: `apps/api-gateway/Program.cs`
- OpenAPI Spec: `packages/contracts/openapi-gateway.yaml`
- Service Health: `services/*/Program.cs` (MapHealthChecks)

```

`artifacts/issuance-endpoints-coverage-report.md`:

```md
# Issuance Service Endpoints Coverage Report

**Generated:** 2025-01-27  
**Task:** NX-03 Issuance Endpoints Coverage

## Executive Summary

–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ Issuance —Å OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏ (`openapi-issuance.yaml`, `openapi-gateway.yaml`), –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–æ–±—ã—Ç–∏–π AsyncAPI, –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã.

## Endpoint Mapping (OpenAPI ‚Üî Code)

| OpenAPI Endpoint | Method | Service Endpoint | Handler | Status | Notes |
|-----------------|--------|------------------|---------|--------|-------|
| `/v1/issuances` | POST | `/v1/issuances` | `Program.cs:185` ‚Üí `IssuanceService.CreateAsync` | ‚úÖ | –°–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ |
| `/v1/issuances/{id}` | GET | `/v1/issuances/{id:guid}` | `Program.cs:216` ‚Üí `IssuanceService.GetByIdAsync` | ‚úÖ | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID |
| `/v1/issuances/{id}/publish` | POST | `/v1/issuances/{id:guid}/publish` | `Program.cs:228` ‚Üí `IssuanceService.PublishAsync` | ‚úÖ | –ü—É–±–ª–∏–∫–∞—Ü–∏—è |
| `/v1/issuances/{id}/close` | POST | `/v1/issuances/{id:guid}/close` | `Program.cs:253` ‚Üí `IssuanceService.CloseAsync` | ‚úÖ | –ó–∞–∫—Ä—ã—Ç–∏–µ |

**Gateway Mapping:**
- Gateway `/issuances` ‚Üí YARP transform ‚Üí Service `/v1/issuances` ‚úÖ

## DTO & Validators

### CreateIssuanceRequest
- **Location:** `services/issuance/DTOs/CreateIssuanceRequest.cs`
- **OpenAPI Schema:** `packages/contracts/openapi-issuance.yaml` ‚Üí `CreateIssuanceRequest`
- **Status:** ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
- **Fields:**
  - `assetId` (Guid, required) ‚úÖ
  - `issuerId` (Guid, required) ‚úÖ
  - `totalAmount` (decimal, required, > 0) ‚úÖ
  - `nominal` (decimal, required, > 0) ‚úÖ
  - `issueDate` (DateOnly, required) ‚úÖ
  - `maturityDate` (DateOnly, required) ‚úÖ
  - `scheduleJson` (Dictionary<string, object>?, optional) ‚úÖ

### IssuanceResponse
- **Location:** `services/issuance/DTOs/IssuanceResponse.cs`
- **OpenAPI Schema:** `packages/contracts/openapi-issuance.yaml` ‚Üí `IssuanceResponse`
- **Status:** ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
- **Fields:** –í—Å–µ –ø–æ–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç OpenAPI —Å—Ö–µ–º–µ

### Validators
- **Location:** `services/issuance/Validators/CreateIssuanceRequestValidator.cs`
- **Status:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å FluentValidation
- **Rules:**
  - AssetId, IssuerId: NotEmpty ‚úÖ
  - TotalAmount, Nominal: GreaterThan(0) ‚úÖ
  - IssueDate, MaturityDate: NotEmpty ‚úÖ
  - MaturityDate > IssueDate ‚úÖ

## Authentication & Authorization

### Security Schemes (OpenAPI)
- **BearerAuth:** JWT Bearer token (OIDC/Keycloak)
- **Location:** `packages/contracts/openapi-gateway.yaml` ‚Üí `components.securitySchemes.BearerAuth`

### Implementation
- **Location:** `services/issuance/Program.cs:83-105`
- **Status:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **Details:**
  - JWT Bearer authentication (`AddJwtBearer`)
  - Keycloak authority configuration
  - Authorization policies:
    - `role:issuer` ‚Äî –¥–ª—è POST `/issuances`, `/publish`, `/close`
    - `role:any-auth` ‚Äî –¥–ª—è GET `/issuances/{id}`

**SPEC DIFF:** OpenAPI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `security: BearerAuth` –¥–ª—è –≤—Å–µ—Ö endpoints, –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ `role:issuer` –∏ `role:any-auth`. –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é + —Ä–æ–ª—å.

## Events (AsyncAPI ‚Üî Code)

### ois.issuance.published

**AsyncAPI Schema:**
- **Topic:** `ois.issuance.published`
- **Payload:** `IssuancePublishedPayload`
- **Required fields:** `issuanceId`, `assetId`, `issuerId`, `publishedAt`
- **Optional fields:** `totalAmount`, `schedule`, `metadata`

**Code Implementation:**
- **Location:** `services/issuance/Services/IssuanceService.cs:121-130`
- **Status:** ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
- **Payload:**
  ```csharp
  {
      issuanceId = issuance.Id,        // ‚úÖ required
      assetId = issuance.AssetId,      // ‚úÖ required
      issuerId = issuance.IssuerId,    // ‚úÖ required
      totalAmount = issuance.TotalAmount, // ‚úÖ optional
      schedule = schedule,              // ‚úÖ optional
      publishedAt = issuance.PublishedAt, // ‚úÖ required
      dltTxHash = txHash               // ‚ö†Ô∏è –Ω–µ –≤ AsyncAPI (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ)
  }
  ```

**SPEC DIFF:** –ö–æ–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç `dltTxHash` –≤ payload, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ AsyncAPI. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å `dltTxHash` –≤ `IssuancePublishedPayload` –≤ AsyncAPI –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ–¥–∞.

### ois.issuance.closed

**AsyncAPI Schema:**
- **Topic:** `ois.issuance.closed`
- **Payload:** `IssuanceClosedPayload`
- **Required fields:** `issuanceId`, `closedAt`
- **Optional fields:** `reason`

**Code Implementation:**
- **Location:** `services/issuance/Services/IssuanceService.cs:177-182`
- **Status:** ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
- **Payload:**
  ```csharp
  {
      issuanceId = issuance.Id,    // ‚úÖ required
      closedAt = issuance.ClosedAt, // ‚úÖ required
      dltTxHash = txHash           // ‚ö†Ô∏è –Ω–µ –≤ AsyncAPI (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ)
  }
  ```

**SPEC DIFF:** –ö–æ–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç `dltTxHash` –≤ payload, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ AsyncAPI. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å `dltTxHash` –≤ `IssuanceClosedPayload` –≤ AsyncAPI –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ–¥–∞.

### Outbox Pattern
- **Location:** `services/issuance/Services/OutboxService.cs`
- **Status:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- **Publisher:** `services/issuance/Background/OutboxPublisher.cs`
- **Topics:** `ois.issuance.published`, `ois.issuance.closed`

## Tests

### Test Structure
- **Location:** `services/issuance/issuance.Tests/` (—Å–æ–∑–¥–∞–Ω–æ)
- **Also exists:** `tests/issuance.Tests/` (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã)

### Unit Tests (IssuanceServiceTests.cs)
- ‚úÖ `CreateAsync_ShouldCreateDraftIssuance`
- ‚úÖ `GetByIdAsync_ExistingIssuance_ReturnsIssuance`
- ‚úÖ `GetByIdAsync_NonExistent_ReturnsNull`
- ‚úÖ `PublishAsync_DraftIssuance_PublishesAndPublishesEvent`
- ‚úÖ `PublishAsync_NonDraftStatus_ThrowsException`
- ‚úÖ `PublishAsync_NonExistent_ThrowsException`
- ‚úÖ `CloseAsync_PublishedIssuance_ClosesAndPublishesEvent`
- ‚úÖ `CloseAsync_NonPublishedStatus_ThrowsException`
- ‚úÖ `CloseAsync_NonExistent_ThrowsException`

### Integration Tests (IssuanceApiTests.cs)
- ‚úÖ `POST_Issuances_ValidRequest_Returns201`
- ‚úÖ `POST_Issuances_InvalidRequest_Returns400`
- ‚úÖ `GET_Issuances_ExistingId_Returns200`
- ‚úÖ `GET_Issuances_NonExistentId_Returns404`
- ‚úÖ `POST_Publish_ExistingDraft_Returns200`
- ‚ö†Ô∏è `POST_Publish_NonExistent_Returns404` ‚Äî —Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –≤–º–µ—Å—Ç–æ 404)
- ‚úÖ `POST_Close_ExistingPublished_Returns200`
- ‚úÖ `POST_Close_NonExistent_Returns404`
- ‚úÖ `POST_Issuances_Unauthorized_Returns401`

### Test Results
- **Location:** `artifacts/issuance-test-report.txt`
- **Status:** 
  - ‚úÖ 1 —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç (`IssuanceServiceTests.CreateAsync_ShouldCreateDraftIssuance`)
  - ‚ö†Ô∏è 1 —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç (`IssuanceApiTests.Publish_NonExistent_Should_Return_404`) ‚Äî –æ–∂–∏–¥–∞–µ—Ç 404, –ø–æ–ª—É—á–∞–µ—Ç 500
  - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è issuance –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `PublishAsync` –≤ `Program.cs:233-235`
  - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢–µ—Å—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞. –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å.

## Recommendations

1. **AsyncAPI:** –î–æ–±–∞–≤–∏—Ç—å `dltTxHash` –≤ `IssuancePublishedPayload` –∏ `IssuanceClosedPayload` –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–æ–¥—É, –ª–∏–±–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ–¥–∞.

2. **Error Handling:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è issuance –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `PublishAsync` –∏ `CloseAsync` –≤ `Program.cs:233-235, 262-264`.

3. **Tests:** –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –≤ `services/issuance/issuance.Tests/`. –û–¥–∏–Ω —Ç–µ—Å—Ç –º–æ–∂–µ—Ç –ø–∞–¥–∞—Ç—å –∏–∑-–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞ ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞.

4. **Documentation:** ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ ‚Äî `docs/services/issuance.md` –¥–æ–ø–æ–ª–Ω–µ–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–æ–±—ã—Ç–∏—è—Ö, –∏—Ö payload –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ AsyncAPI.

## Verification Commands

```bash
# Run tests
dotnet test services/issuance/issuance.Tests.csproj -v minimal

# Or use existing tests
dotnet test tests/issuance.Tests/issuance.Tests.csproj -v minimal

# Check OpenAPI spec
spectral lint packages/contracts/openapi-issuance.yaml

# Check AsyncAPI spec
asyncapi validate packages/contracts/asyncapi.yaml
```

## References

- OpenAPI Spec: `packages/contracts/openapi-issuance.yaml`
- Gateway Spec: `packages/contracts/openapi-gateway.yaml`
- AsyncAPI Spec: `packages/contracts/asyncapi.yaml`
- Service Code: `services/issuance/`
- Tests: `services/issuance/issuance.Tests/`, `tests/issuance.Tests/`


```

`artifacts/issuance-test-report.txt`:

```txt
# Issuance Service Tests Report

**Generated:** 2025-11-18  
**Task:** NX-03 Issuance Endpoints Coverage (re-check on infra.defis.deploy, .NET 9)

## Commands

```bash
# Issuance API + service tests (net9.0)
$HOME/.dotnet/dotnet test tests/issuance.Tests/issuance.Tests.csproj -v minimal
```

## Summary

- Test project: `tests/issuance.Tests/issuance.Tests.csproj` (TargetFramework: net9.0).
- Service project: `services/issuance/issuance.csproj` (TargetFramework: net9.0).
- Domain project: `packages/domain/domain.csproj` (TargetFramework: net9.0).

### Results

- ‚úÖ `OIS.Issuance.Tests.IssuanceServiceTests.CreateAsync_ShouldCreateDraftIssuance`
- ‚ö†Ô∏è `OIS.Issuance.Tests.IssuanceApiTests.Publish_NonExistent_Should_Return_404`
  - **Expected:** `HttpStatusCode.NotFound`
  - **Actual:** `HttpStatusCode.InternalServerError`
  - **Location:** `tests/issuance.Tests/IssuanceApiTests.cs:line 42`

### Notes

- –¢–µ—Å—Ç—ã —Å–æ–±–∏—Ä–∞–ª–∏—Å—å –∏ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º SDK `.NET 9.0.307` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–∫–µ—Ç–æ–≤:
  - `Microsoft.NET.Test.Sdk` 17.11.0
  - `xunit` 2.9.0 (runner 2.8.2)
  - `Microsoft.AspNetCore.Mvc.Testing` 9.0.0
- –î–ª—è —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ —Ç–µ—Å—Ç–æ–≤ –≤–Ω–µ—Å–µ–Ω—ã –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ `ProjectReference` –≤ `services/issuance/issuance.Tests.csproj` —Å `..\issuance.csproj` –Ω–∞ `issuance.csproj`.
  - –î–æ–±–∞–≤–ª–µ–Ω—ã `using Microsoft.Extensions.Logging`, `using Microsoft.Extensions.DependencyInjection`, `using Microsoft.Extensions.Configuration`, `using Microsoft.AspNetCore.Builder` –≤ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∫–æ–¥, —á—Ç–æ–±—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥—Ç—è–Ω—É—Ç—å ASP.NET Core extension methods –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –ø–æ–¥ .NET 9.
  - –î–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π `PackageReference` –Ω–∞ `Microsoft.TestPlatform.TestHost` 17.11.0.

## Interpretation for NX-03

- **Endpoints ‚Üî OpenAPI:** –ø–æ–∫—Ä—ã—Ç–∏–µ –∏–∑ `artifacts/issuance-endpoints-coverage-report.md` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —Å–±–æ—Ä–∫–æ–π —Å–µ—Ä–≤–∏—Å–∞ `issuance` –ø–æ–¥ .NET 9; compile-time –æ—à–∏–±–æ–∫ –ø–æ DTO/–º–∞—Ä—à—Ä—É—Ç–∞–º –Ω–µ—Ç.
- **Events ‚Üî AsyncAPI:** —Å–æ–±—ã—Ç–∏—è `ois.issuance.published` / `ois.issuance.closed` –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –∏–º–µ—Ç—å SPEC DIFF –ø–æ –ø–æ–ª—é `dltTxHash` (—Å–º. coverage-report) ‚Äî —ç—Ç–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π gap, –∞ –Ω–µ runtime-–æ—à–∏–±–∫–∞.
- **Tests:** –Ω–∞ —Ç–µ–∫—É—â–µ–º —Å—Ä–µ–∑–µ –≤–µ—Ç–∫–∏:
  - Unit-—Ç–µ—Å—Ç `CreateAsync_ShouldCreateDraftIssuance` –∑–µ–ª—ë–Ω—ã–π.
  - API-—Ç–µ—Å—Ç `Publish_NonExistent_Should_Return_404` –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –≤—ã—è–≤–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ `500` –≤–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ `404` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ publish –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –≤—ã–ø—É—Å–∫–∞.

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã –ø–æ NX-03:

- –õ–æ–∫–∞–ª—å–Ω–æ (–Ω–∞ eywa1) –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–æ–≥–Ω–∞—Ç—å:

```bash
cd repositories/customer-gitlab/wt__ois-cfa__NX01
$HOME/.dotnet/dotnet test tests/issuance.Tests/issuance.Tests.csproj -v minimal
```

- –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å—Ä–µ–¥–µ:
  - –ª–∏–±–æ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É `Publish_NonExistent` (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π guard/–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∫—Ä—É–≥ `GetByIdAsync` –∏ `PublishAsync`), 
  - –ª–∏–±–æ, –µ—Å–ª–∏ 500 —Å–≤—è–∑–∞–Ω —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ö–æ—Å—Ç–∞, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –∫–∞–∫ Known Issue –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º SPEC DIFF / tech debt –∑–∞–ø–∏—Å–∏.


```

`artifacts/spec-lint-openapi.txt`:

```txt
No results with a severity of 'error' found!

```

`artifacts/spec-validate-asyncapi.txt`:

```txt

AsyncAPI anonymously tracks command executions to improve the specification and tools, ensuring no sensitive data reaches our servers. It aids in comprehending how AsyncAPI tools are used and adopted, facilitating ongoing improvements to our specifications and tools.

To disable tracking, please run the following command:
  asyncapi config analytics --disable

Once disabled, if you want to enable tracking back again then run:
  asyncapi config analytics --enable


File packages/contracts/asyncapi.yaml is valid but has (itself and/or referenced documents) governance issues.
Warnings 
packages/contracts/asyncapi.yaml
   1:1   warning  asyncapi-id                  AsyncAPI document should have "id" field.
   1:1   warning  asyncapi2-tags               AsyncAPI object should have non-empty "tags" array.
   2:6   warning  asyncapi-info-contact        Info object should have "contact" object.            info
   2:6   warning  asyncapi-info-license        Info object should have "license" object.            info
 129:18  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.OrderCreated
 136:19  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.OrderReserved
 143:15  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.OrderPaid
 149:23  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.IssuancePublished
 156:20  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.IssuanceClosed
 163:17  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.OrderPlaced
 170:20  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.OrderConfirmed
 177:20  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.PayoutExecuted
 184:21  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.PayoutScheduled
 191:17  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.AuditLogged
 198:23  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.TransferCompleted
 205:25  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.RegistryTransferred
 212:23  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.ComplianceFlagged
 219:16  warning  asyncapi2-message-messageId  Message should have a "messageId" field defined.     components.messages.KycUpdated

‚úñ 18 problems (0 errors, 18 warnings, 0 infos, 0 hints)

Information 
packages/contracts/asyncapi.yaml
 1:11  information  asyncapi-latest-version  The latest version of AsyncAPi is not used. It is recommended update to the "3.0.0" version.  asyncapi

‚úñ 1 problem (0 errors, 0 warnings, 1 info, 0 hints)


```

`artifacts/spec-validate-jsonschema.txt`:

```txt
### packages/contracts/schemas/AuditEvent.json
schema packages/contracts/schemas/AuditEvent.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/BrokerClient.json
schema packages/contracts/schemas/BrokerClient.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/BrokerOrder.json
schema packages/contracts/schemas/BrokerOrder.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/CFA.json
schema packages/contracts/schemas/CFA.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/CommissionRow.json
schema packages/contracts/schemas/CommissionRow.json is invalid
error: unknown format "decimal" ignored in schema at path "#/properties/totalAmount"

### packages/contracts/schemas/Complaint.json
schema packages/contracts/schemas/Complaint.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/FeedItem.json
schema packages/contracts/schemas/FeedItem.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/Holding.json
schema packages/contracts/schemas/Holding.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/issuanceId"

### packages/contracts/schemas/Issuance.json
schema packages/contracts/schemas/Issuance.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/IssuerReportRow.json
schema packages/contracts/schemas/IssuerReportRow.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/issuanceId"

### packages/contracts/schemas/KycDecision.json
schema packages/contracts/schemas/KycDecision.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/KycDocument.json
schema packages/contracts/schemas/KycDocument.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/KycResult.json
schema packages/contracts/schemas/KycResult.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/investorId"

### packages/contracts/schemas/MarketIssuanceCard.json
schema packages/contracts/schemas/MarketIssuanceCard.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/Order.json
schema packages/contracts/schemas/Order.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/PayoutBatch.json
schema packages/contracts/schemas/PayoutBatch.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/PayoutItem.json
schema packages/contracts/schemas/PayoutItem.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/Payout.json
schema packages/contracts/schemas/Payout.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/QualificationResult.json
schema packages/contracts/schemas/QualificationResult.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/investorId"

### packages/contracts/schemas/ReconciliationReport.json
schema packages/contracts/schemas/ReconciliationReport.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/batchId"

### packages/contracts/schemas/RegistryTx.json
schema packages/contracts/schemas/RegistryTx.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/TxHistoryItem.json
schema packages/contracts/schemas/TxHistoryItem.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/id"

### packages/contracts/schemas/Wallet.json
schema packages/contracts/schemas/Wallet.json is invalid
error: unknown format "uuid" ignored in schema at path "#/properties/investorId"


```